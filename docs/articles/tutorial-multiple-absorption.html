<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Multiple Absorption Tutorial â€¢ samc</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multiple Absorption Tutorial">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">samc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/article-circuit-theory.html">Circuit Theory</a></li>
    <li><a class="dropdown-item" href="../articles/article-computation-methods.html">Computation Methods</a></li>
    <li><a class="dropdown-item" href="../articles/article-models.html">Models</a></li>
    <li><a class="dropdown-item" href="../articles/performance.html">Performance</a></li>
    <li><a class="dropdown-item" href="../articles/parallel.html">Parallel Computing</a></li>
    <li><a class="dropdown-item" href="../articles/troubleshooting.html">Troubleshooting</a></li>
    <li><a class="dropdown-item" href="../articles/code-snippets.html">Code Snippets</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-data" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Data</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-data">
<li><a class="dropdown-item" href="../articles/data-disconnected.html">Disconnected Data</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../articles/tutorial-basic.html">Basic Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-locations.html">Locations</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-ggplot.html">ggplot Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-temporal.html">Temporal Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-animations.html">Animations</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-multiple-absorption.html">Multiple Absorption</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><a class="dropdown-item" href="../articles/example-coinflip.html">Coin Flip</a></li>
    <li><a class="dropdown-item" href="../articles/example-maze-part1.html">Maze (Part 1)</a></li>
    <li><a class="dropdown-item" href="../articles/example-maze-part2.html">Maze (Part 2)</a></li>
    <li><a class="dropdown-item" href="../articles/example-maze-part3.html">Maze (Part 3)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/andrewmarx/samc"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Multiple Absorption Tutorial</h1>
                        <h4 data-toc-skip class="author">Andrew
Marx</h4>
            
            <h4 data-toc-skip class="date">2024-10-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/andrewmarx/samc/blob/HEAD/vignettes/tutorial-multiple-absorption.Rmd" class="external-link"><code>vignettes/tutorial-multiple-absorption.Rmd</code></a></small>
      <div class="d-none name"><code>tutorial-multiple-absorption.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Starting in v1.4.0, the samc package included support for multiple
sources of absorption when creating an samc object. Additionally, when
multiple sources of absorption are provided, the results of the
mortality() metric are now decomposed into its individual and total
components, which are returned in a named list. When only a single
absorption input is provided, the function will work exactly like it did
previously to maintain backwards compatibility with existing code.</p>
<p><em>Note: only the asymptotic (long-term) calculations are currently
decomposed. The short-term mortality metrics still need to be
updated.</em></p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>For this example, we will use the example data included in the
package, but will semi-randomly divide/decompose the absorption matrix
into two separate layers. These layers are used for illustrative
purposes and do not represent anything meaningful.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First step is to load the libraries. Not all of these libraries are strictly</span></span>
<span><span class="co"># needed; some are used for convenience and visualization for this tutorial.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://rspatial.org/" class="external-link">"terra"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://andrewmarx.github.io/samc/" class="external-link">"samc"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://sjmgarnier.github.io/viridisLite/" class="external-link">"viridisLite"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># "Load" the data. In this case we are using data built into the package.</span></span>
<span><span class="co"># In practice, users will likely load raster data using the raster() function</span></span>
<span><span class="co"># from the raster package.</span></span>
<span><span class="va">res_data</span> <span class="op">&lt;-</span> <span class="fu">samc</span><span class="fu">::</span><span class="va"><a href="../reference/example_split_corridor.html">example_split_corridor</a></span><span class="op">$</span><span class="va">res</span></span>
<span><span class="va">abs_data</span> <span class="op">&lt;-</span> <span class="fu">samc</span><span class="fu">::</span><span class="va"><a href="../reference/example_split_corridor.html">example_split_corridor</a></span><span class="op">$</span><span class="va">abs</span></span>
<span></span>
<span><span class="co"># To make things easier for plotting later, convert the matrices to rasters</span></span>
<span><span class="va">res_data</span> <span class="op">&lt;-</span> <span class="fu">samc</span><span class="fu">::</span><span class="fu"><a href="../reference/rasterize.html">rasterize</a></span><span class="op">(</span><span class="va">res_data</span><span class="op">)</span></span>
<span><span class="va">abs_data</span> <span class="op">&lt;-</span> <span class="fu">samc</span><span class="fu">::</span><span class="fu"><a href="../reference/rasterize.html">rasterize</a></span><span class="op">(</span><span class="va">abs_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate some random values that will be used as proportions for dividing the</span></span>
<span><span class="co"># absorption data.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">abs_data</span><span class="op">)</span>, max <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">p1</span></span>
<span></span>
<span><span class="co"># Divide our absorption data into two layers. When added together, these two</span></span>
<span><span class="co"># layers should be identical to the original</span></span>
<span><span class="va">abs_data_a</span> <span class="op">&lt;-</span> <span class="va">abs_data</span> <span class="op">*</span> <span class="va">p1</span></span>
<span><span class="va">abs_data_b</span> <span class="op">&lt;-</span> <span class="va">abs_data</span> <span class="op">*</span> <span class="va">p2</span></span>
<span></span>
<span><span class="co"># With terra, make sure each layer has a unique name</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">abs_data_a</span><span class="op">)</span> <span class="op">=</span> <span class="st">"abs1"</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">abs_data_b</span><span class="op">)</span> <span class="op">=</span> <span class="st">"abs2"</span></span>
<span></span>
<span><span class="co"># Verify</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">abs_data_a</span> <span class="op">+</span> <span class="va">abs_data_b</span>, <span class="va">abs_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Names: 1 string mismatch"                                                 </span></span>
<span><span class="co">#&gt; [2] "Attributes: &lt; Component \"ptr\": Component \"names\": 1 string mismatch &gt;"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="total-single-absorption">Total (Single) Absorption<a class="anchor" aria-label="anchor" href="#total-single-absorption"></a>
</h2>
<p>The use of multiple absorption layers is mainly of interest for the
mortality() metric, which calculates the probability of absorption at
different transient states or locations. By providing multiple
absorption layers, we can tease apart the role that different sources of
absorption might have in a model. To start, we will work with the total
absorption.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Setup the details for our transition function</span></span>
<span><span class="va">rw_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="co"># Function for calculating transition probabilities</span></span>
<span>           dir <span class="op">=</span> <span class="fl">8</span>, <span class="co"># Directions of the transitions. Either 4 or 8.</span></span>
<span>           sym <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Is the function symmetric?</span></span>
<span></span>
<span><span class="co"># Create the samc object using the original "total" absorption layer</span></span>
<span><span class="va">samc_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/samc.html">samc</a></span><span class="op">(</span><span class="va">res_data</span>, <span class="va">abs_data</span>, model <span class="op">=</span> <span class="va">rw_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Let's say we're interested in where absorption is expected to occur throughout</span></span>
<span><span class="co"># the model if starting from a single location</span></span>
<span><span class="va">mort</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mortality.html">mortality</a></span><span class="op">(</span><span class="va">samc_obj</span>, origin <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># When only working with total absorption, this version of mortality() returns</span></span>
<span><span class="co"># a named vector</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">mort</span><span class="op">)</span></span>
<span><span class="co">#&gt;  num [1:2624] 0.000783 0.000787 0.000704 0.000655 0.000621 ...</span></span>
<span></span>
<span><span class="co"># Let's visualize it</span></span>
<span><span class="va">mort_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">mort</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mort_map</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"y"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="tutorial-multiple-absorption_files/figure-html/unnamed-chunk-2-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="multiple-absorption">Multiple Absorption<a class="anchor" aria-label="anchor" href="#multiple-absorption"></a>
</h2>
<p>Since our data is a matrix object, we will provide the decomposed
absorption layers in a list object. When using raster data, it would be
provided as either a RasterStack or a RasterBrick. The layers in the
list/RasterStack/RasterBrick can be named, which will carryover into the
results, which can help with code readability when accessing different
parts of the results.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Let's attach absorption layers to our samc object</span></span>
<span><span class="va">samc_obj</span><span class="op">$</span><span class="va">abs_states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">abs_data_a</span>, <span class="va">abs_data_b</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now rerun the analysis</span></span>
<span><span class="va">mort_multiple</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mortality.html">mortality</a></span><span class="op">(</span><span class="va">samc_obj</span>, origin <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Let's note the differences from what was returned before. Here, we have a list</span></span>
<span><span class="co"># of named vectors. The first is for the total absorption. The last two are for</span></span>
<span><span class="co"># the subdivided or decomposed absorption inputs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">mort_multiple</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ total: num [1:2624] 0.000783 0.000787 0.000704 0.000655 0.000621 ...</span></span>
<span><span class="co">#&gt;  $ abs1 : num [1:2624] 1.90e-05 1.91e-05 1.71e-05 1.59e-05 1.51e-05 ...</span></span>
<span><span class="co">#&gt;  $ abs2 : num [1:2624] 0.000764 0.000768 0.000687 0.000639 0.000606 ...</span></span>
<span></span>
<span><span class="co"># Let's visualize it</span></span>
<span><span class="va">multiple_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">mort_multiple</span><span class="op">)</span></span>
<span><span class="va">multiple_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">multiple_map</span><span class="op">)</span> <span class="co"># Convert the list to a multi-layer SpatRaster for plotting</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">multiple_map</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"y"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span>, nc <span class="op">=</span> <span class="fl">1</span>, nr <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="tutorial-multiple-absorption_files/figure-html/unnamed-chunk-3-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="co"># Let's check some things.</span></span>
<span></span>
<span><span class="co">#First, the results of the decomposed layers in the list should add up to the total result</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">multiple_map</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, mat <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">multiple_map</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">multiple_map</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, mat <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co"># Alternatively, we could use the layer names:</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">multiple_map</span><span class="op">$</span><span class="va">total</span>, mat <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">multiple_map</span><span class="op">$</span><span class="va">abs1</span> <span class="op">+</span> <span class="va">multiple_map</span><span class="op">$</span><span class="va">abs2</span>, mat <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># Second, notice in the plots above that the result for the single input and the total</span></span>
<span><span class="co"># result for the multiple input look very similar? That's because they are identical</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">mort</span>, <span class="va">mort_multiple</span><span class="op">$</span><span class="va">total</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="partial-absorption-data">Partial Absorption Data<a class="anchor" aria-label="anchor" href="#partial-absorption-data"></a>
</h2>
<p>In the above code, the decomposed absorption data sums to the total
absorption data. This is not strictly necessary, and the decomposed
absorption data can consist of any number of inputs. These inputs are
treated independently of one another by the package. This is potentially
useful in at least two different situations.</p>
<p>The first situation is where we are only interested in the results
for a subset of the absorption components. In other words, there might
be multiple sources of absorption contributing to the total overall
absorption used to create the samc object, but our analysis might be
only interested in learning about one of them. In that case, we only
need to supply the absorption probabilities for what we are interested
in; the others can be excluded.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Let's say we are interested in just the first component we created above</span></span>
<span><span class="va">samc_obj</span><span class="op">$</span><span class="va">abs_states</span> <span class="op">&lt;-</span> <span class="va">abs_data_a</span></span>
<span></span>
<span><span class="va">mort_partial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mortality.html">mortality</a></span><span class="op">(</span><span class="va">samc_obj</span>, origin <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Let's visualize it. Note that the results are the same as before, just without</span></span>
<span><span class="co"># the second component.</span></span>
<span><span class="va">partial_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">mort_partial</span><span class="op">)</span></span>
<span><span class="va">partial_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">partial_map</span><span class="op">)</span> <span class="co"># Convert the list to a RasterStack for plotting</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">partial_map</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"y"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span>, nc <span class="op">=</span> <span class="fl">1</span>, nr <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="tutorial-multiple-absorption_files/figure-html/unnamed-chunk-4-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The second situation is where we might have multiple candidate models
for a particular source of absorption. Rather than running the analysis
once for every candidate, we can simply include them all and run the
analysis once.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create multiple versions of our first component. This might represent multiple</span></span>
<span><span class="co"># models or hypotheses we want to explore</span></span>
<span><span class="va">abs_1_models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">abs_data_a</span> <span class="op">*</span> <span class="fl">0.2</span>,</span>
<span>                  <span class="va">abs_data_a</span> <span class="op">*</span> <span class="fl">0.4</span>,</span>
<span>                  <span class="va">abs_data_a</span> <span class="op">*</span> <span class="fl">0.6</span>,</span>
<span>                  <span class="va">abs_data_a</span> <span class="op">*</span> <span class="fl">0.8</span>,</span>
<span>                  <span class="va">abs_data_a</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">abs_1_models</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"abs1_2"</span>, <span class="st">"abs1_4"</span>, <span class="st">"abs1_6"</span>, <span class="st">"abs1_8"</span>, <span class="st">"abs1"</span><span class="op">)</span></span>
<span><span class="va">samc_obj</span><span class="op">$</span><span class="va">abs_states</span> <span class="op">&lt;-</span> <span class="va">abs_1_models</span></span>
<span></span>
<span><span class="va">mort_models</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mortality.html">mortality</a></span><span class="op">(</span><span class="va">samc_obj</span>, origin <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Let's visualize it. Note that the results are not particularly interesting visually;</span></span>
<span><span class="co"># the only difference between these models is the scale</span></span>
<span><span class="va">models_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">mort_models</span><span class="op">)</span></span>
<span><span class="va">models_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">models_map</span><span class="op">)</span> <span class="co"># Convert the list to a RasterStack for plotting</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">models_map</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"y"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span>, nc <span class="op">=</span> <span class="fl">2</span>, nr <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="tutorial-multiple-absorption_files/figure-html/unnamed-chunk-5-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="calculating-total-absorption-from-individual-components">Calculating Total Absorption From Individual Components<a class="anchor" aria-label="anchor" href="#calculating-total-absorption-from-individual-components"></a>
</h2>
<p>Up to this point, total absorption in our examples is assumed to have
already been known. One possibility is that total absorption is known or
estimated directly from empirical data. This section, however, comments
on the situation where itâ€™s the individual absorption components (e.g.,
different sources of absorption) that have been directly measured or
estimated, and now the user is in a situation where they need to combine
that data into total absorption that they can use as input into the
samc() function. Ultimately, any number of arbitrary mathematical
functions could be used to combine the individual components into a
total absorption. As a starting point, however, users may want to think
about how their data fits into probability theory.</p>
<p>Letâ€™s say we have two possible sources of absorption
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>.
If they cannot occur at the same time, they are mutually exclusive, or
disjoint, events. An example of this might be a deer dispersing across a
landscape that can die to either predation or road mortality (hit by a
vehicle). In this case, both types of absorption result in death of the
deer, and since a deer cannot die twice, this means that both types of
absorption are mutually exclusive. Under the rules of probability, we
can then calculate our total absorption as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> or </mtext><mspace width="0.333em"></mspace></mrow><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(A\text{ or }B) = P(A) + P(B)</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">Probability of Predation</mtext></mrow><annotation encoding="application/x-tex">P(A) = \text{Probability of Predation}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">Probability of Road Mortality</mtext></mrow><annotation encoding="application/x-tex">P(B) = \text{Probability of Road Mortality}</annotation></semantics></math>.</p>
<p>More complex scenarios are possible. Itâ€™s conceivable that there
might be situations where two or more or different sources of absorption
can occur simultaneously. In this case, the total absorption could be
calculated as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> or </mtext><mspace width="0.333em"></mspace></mrow><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(A\text{ or }B) = P(A) + P(B) - P(A)P(B)</annotation></semantics></math>.
When interpreting results using multiple absorption in the package, the
results for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(A)P(B)</annotation></semantics></math>
can be calculated either by providing the absorption sources
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
and then multiplying their results after the analysis, or absorption
sources
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
can be pre-multiplied into a single absorbing state which is then used
as an absorbing state for the analysis.</p>
</div>
<div class="section level2">
<h2 id="disabling-multiple-absorption">Disabling Multiple Absorption<a class="anchor" aria-label="anchor" href="#disabling-multiple-absorption"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># To remove all the absorption components</span></span>
<span><span class="va">samc_obj</span><span class="op">$</span><span class="va">abs_states</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrew Marx.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
