<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Computation Methods • samc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Computation Methods">
<meta property="og:description" content="samc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">samc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/article-circuit-theory.html">Circuit Theory</a>
    </li>
    <li>
      <a href="../articles/article-computation-methods.html">Computation Methods</a>
    </li>
    <li>
      <a href="../articles/article-models.html">Models</a>
    </li>
    <li>
      <a href="../articles/performance.html">Performance</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Parallel Computing</a>
    </li>
    <li>
      <a href="../articles/troubleshooting.html">Troubleshooting</a>
    </li>
    <li>
      <a href="../articles/code-snippets.html">Code Snippets</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data-disconnected.html">Disconnected Data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tutorial-basic.html">Basic Tutorial</a>
    </li>
    <li>
      <a href="../articles/tutorial-locations.html">Locations</a>
    </li>
    <li>
      <a href="../articles/tutorial-ggplot.html">ggplot Visualization</a>
    </li>
    <li>
      <a href="../articles/tutorial-temporal.html">Temporal Analysis</a>
    </li>
    <li>
      <a href="../articles/tutorial-animations.html">Animations</a>
    </li>
    <li>
      <a href="../articles/tutorial-multiple-absorption.html">Multiple Absorption</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/example-coinflip.html">Coin Flip</a>
    </li>
    <li>
      <a href="../articles/example-maze-part1.html">Maze (Part 1)</a>
    </li>
    <li>
      <a href="../articles/example-maze-part2.html">Maze (Part 2)</a>
    </li>
    <li>
      <a href="../articles/example-maze-part3.html">Maze (Part 3)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/andrewmarx/samc" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Computation Methods</h1>
                        <h4 data-toc-skip class="author">Andrew
Marx</h4>
            
            <h4 data-toc-skip class="date">2023-05-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/andrewmarx/samc/blob/HEAD/vignettes/article-computation-methods.Rmd" class="external-link"><code>vignettes/article-computation-methods.Rmd</code></a></small>
      <div class="hidden name"><code>article-computation-methods.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>There are multiple approaches to calculating the results of samc
metrics. Initially, the package only provided one, but two others have
been added since, with the original remaining the default. These
approaches have tradeoffs in speed, memory usage, and supported
features, which means that the “best” one depends on the user’s data,
goals, and computing resources.</p>
</div>
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<div class="section level3">
<h3 id="linear-algebra-solvers">Linear Algebra Solvers<a class="anchor" aria-label="anchor" href="#linear-algebra-solvers"></a>
</h3>
<p>Linear algebra solvers take the transition matrix and calculate the
results for the metrics as a system of linear equations. Currently, the
samc package supports two different linear algebra solvers. These
solvers only affect the behavior for the long-term metrics; the
short-term metrics are calculated directly using linear algebra in a
loop, so they do not use the solvers. Additionally, the base data
requirements for the different solvers are the same, so a samc object
can be switched from one to the other without recreating the transition
matrix.</p>
<div class="section level4">
<h4 id="direct-solver">Direct Solver<a class="anchor" aria-label="anchor" href="#direct-solver"></a>
</h4>
<p><em>Strengths:</em></p>
<ul>
<li>Supports all metrics and models</li>
<li>Intermediate speed during initial long-term metric calculations</li>
<li>Caching behavior makes reruns of long-term metric calculations with
different inputs nearly instantaneous.</li>
</ul>
<p><em>Weaknesses:</em></p>
<ul>
<li>Extremely high memory consumption during long-term metric
calculations</li>
<li>Difficult to parallelize</li>
</ul>
<p>The main benefit of the direct linear algebra behavior is that its
caching behavior makes for very fast repeated runs of long-term metrics.
However, the downside is that it is the most memory-constrained approach
when calculating these metrics.</p>
<p>The direct solver is used by default but can be manually specified
during the creation of the samc object:</p>
<pre><code><span><span class="fu"><a href="../reference/samc.html">samc</a></span><span class="op">(</span><span class="va">...</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"direct"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p>It can also be set after the samc object has been created as long as
long as the samc object is built with a transition matrix:</p>
<pre><code><span><span class="va">samc_obj</span><span class="op">$</span><span class="va">method</span> <span class="op">=</span> <span class="st">"direct"</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="iterative-solver">Iterative Solver<a class="anchor" aria-label="anchor" href="#iterative-solver"></a>
</h4>
<p><em>Strengths:</em></p>
<ul>
<li>Supports all metrics and models</li>
<li>Moderately memory-efficient long-term metric calculations</li>
<li>Potentially some future parallelization with extensive code
rewrites</li>
</ul>
<p><em>Weaknesses:</em></p>
<ul>
<li>Generally slow long-term metric calculations</li>
<li>Little to no benefit from caching behavior</li>
<li>Technically produces an approximate result, but the difference is
not noticeable (within machine precision)</li>
</ul>
<p>The main benefit of the iterative linear algebra solver is that it
can be used for any metric while being memory efficient. The downside is
that it will generally be the slowest option for real-world data.</p>
<p>The iterative solver can be manually specified during the creation of
the samc object:</p>
<pre><code><span><span class="fu"><a href="../reference/samc.html">samc</a></span><span class="op">(</span><span class="va">...</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"iter"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p>It can also be set after the samc object has been created as long as
long as the samc object is built with a transition matrix:</p>
<pre><code><span><span class="va">samc_obj</span><span class="op">$</span><span class="va">method</span> <span class="op">=</span> <span class="st">"iter"</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="convolution">Convolution<a class="anchor" aria-label="anchor" href="#convolution"></a>
</h3>
<p><em>Strengths:</em></p>
<ul>
<li>Very fast samc object creation</li>
<li>Very memory efficient during short- and long-term metric
calculations</li>
<li>Very fast short-term metric calculations</li>
<li>Easily scalable to multiple computational cores</li>
<li>Potential for different computational kernels in the future</li>
</ul>
<p><em>Weaknesses:</em></p>
<ul>
<li>Not supported for all metrics</li>
<li>Metrics can only be calculated using the <code>init</code> parameter
(not <code>origin</code> or <code>dest</code> inputs, but this will be
partially addressed in the future)</li>
<li>
<code>NA</code> values not supported in map inputs</li>
<li>Cannot define custom transition functions</li>
<li>Not supported for correlated random-walk (addressable in the
future)</li>
<li>Cannot calculate long-term metrics directly</li>
</ul>
<p>The convolution method is an entirely different approach from using
linear algebra solvers. The convolution algorithm does not use the
transition matrix, but instead calculates the result using a moving
window across the data. Creation of the samc object with the convolution
method is significantly faster and somewhat more memory efficient as a
result. However, it cannot be switched to a different method after
creation like with the linear algebra solvers.</p>
<p>The convolution algorithm can only calculate results for metrics one
time step or iteration at a time, so calculating long-term metrics
requires running the algorithm long enough for the results to converge
on total absorption. This can be either really fast or slow, depending
on the data distribution in the raster inputs. The convolution algorithm
does benefit from parallelization but currently has significant
diminishing returns after two threads.</p>
<p>When calculating all metrics, the algorithm is very memory efficient,
potentially making it the best (or only) choice when the datasets are
large enough to be memory-constrained. Additionally, for short-term
metrics where the goal is analyses with a specific number of time steps,
the calculations are moderately faster than the linear algebra
approach.</p>
<p>To use the convolution method, it must be specified during the
creation of the samc object:</p>
<pre><code><span><span class="fu"><a href="../reference/samc.html">samc</a></span><span class="op">(</span><span class="va">...</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"conv"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p>It cannot be switched to other methods after creating the samc
object.</p>
</div>
</div>
<div class="section level2">
<h2 id="compatibility-tables">Compatibility Tables<a class="anchor" aria-label="anchor" href="#compatibility-tables"></a>
</h2>
<table class="table">
<thead><tr class="header">
<th align="left">Model</th>
<th align="left">Direct</th>
<th align="left">Iterative</th>
<th align="left">Convolution</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Random Walk</td>
<td align="left">✓</td>
<td align="left">✓</td>
<td align="left">✓<span class="math inline">\(^1\)</span>
</td>
</tr>
<tr class="even">
<td align="left">Correlated RW</td>
<td align="left">✓</td>
<td align="left">✓</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(^1\)</span> See above for limitations of
the convolution random walk.</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="16%">
<col width="33%">
<col width="16%">
<col width="16%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th align="left">Function</th>
<th align="left">Equation</th>
<th align="left">Direct</th>
<th align="left">Iterative</th>
<th align="left">Convolution</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code><a href="../reference/absorption.html">absorption()</a></code></td>
<td align="left"><span class="math inline">\(A = F R\)</span></td>
<td align="left">✓</td>
<td align="left">✓<span class="math inline">\(^2\)</span>
</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><span class="math inline">\(\psi^T A\)</span></td>
<td align="left">✓</td>
<td align="left">✓</td>
<td align="left">✓<span class="math inline">\(^2\)</span>
</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="../reference/cond_passage.html">cond_passage()</a></code></td>
<td align="left"><span class="math inline">\(\tilde{t} =
\tilde{B}_j^{-1}\tilde{F}\tilde{B}_j{\cdot}1\)</span></td>
<td align="left">✓</td>
<td align="left">✓</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/dispersal.html">dispersal()</a></code></td>
<td align="left"><span class="math inline">\(\tilde{D}_{jt}=({\sum}_{n=0}^{t-1}\tilde{Q}^n)\tilde{q}_j\)</span></td>
<td align="left">✓<span class="math inline">\(^1\)</span>
</td>
<td align="left">✓<span class="math inline">\(^1\)</span>
</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><span class="math inline">\(\psi^T\tilde{D}_{jt}\)</span></td>
<td align="left">✓<span class="math inline">\(^1\)</span>
</td>
<td align="left">✓<span class="math inline">\(^1\)</span>
</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><span class="math inline">\(D=(F-I)diag(F)^{-1}\)</span></td>
<td align="left">✓</td>
<td align="left">✓</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><span class="math inline">\(\psi^TD\)</span></td>
<td align="left">✓</td>
<td align="left">✓</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/distribution.html">distribution()</a></code></td>
<td align="left"><span class="math inline">\(Q^t\)</span></td>
<td align="left">✓<span class="math inline">\(^1\)</span>
</td>
<td align="left">✓<span class="math inline">\(^1\)</span>
</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><span class="math inline">\(\psi^TQ^t\)</span></td>
<td align="left">✓<span class="math inline">\(^1\)</span>
</td>
<td align="left">✓<span class="math inline">\(^1\)</span>
</td>
<td align="left">✓</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/mortality.html">mortality()</a></code></td>
<td align="left"><span class="math inline">\(\tilde{B}_t =
(\sum_{n=0}^{t-1} Q^n) \tilde{R}\)</span></td>
<td align="left">✓<span class="math inline">\(^1\)</span>
</td>
<td align="left">✓<span class="math inline">\(^1\)</span>
</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><span class="math inline">\(\psi^T
\tilde{B}_t\)</span></td>
<td align="left">✓<span class="math inline">\(^1\)</span>
</td>
<td align="left">✓<span class="math inline">\(^1\)</span>
</td>
<td align="left">✓</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><span class="math inline">\(B = F
\tilde{R}\)</span></td>
<td align="left">✓</td>
<td align="left">✓</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><span class="math inline">\(\psi^T B\)</span></td>
<td align="left">✓</td>
<td align="left">✓</td>
<td align="left">✓<span class="math inline">\(^2\)</span>
</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/survival.html">survival()</a></code></td>
<td align="left"><span class="math inline">\(z=(I-Q)^{-1}{\cdot}1=F{\cdot}1\)</span></td>
<td align="left">✓</td>
<td align="left">✓</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><span class="math inline">\({\psi}^Tz\)</span></td>
<td align="left">✓</td>
<td align="left">✓</td>
<td align="left">✓<span class="math inline">\(^2\)</span>
</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/visitation.html">visitation()</a></code></td>
<td align="left"><span class="math inline">\(\tilde{F}_t =
\sum_{n=0}^{t-1} Q^n\)</span></td>
<td align="left">✓<span class="math inline">\(^1\)</span>
</td>
<td align="left">✓<span class="math inline">\(^1\)</span>
</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><span class="math inline">\({\psi}^T
\tilde{F}_t\)</span></td>
<td align="left">✓<span class="math inline">\(^1\)</span>
</td>
<td align="left">✓<span class="math inline">\(^1\)</span>
</td>
<td align="left">✓</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><span class="math inline">\(F =
(I-Q)^{-1}\)</span></td>
<td align="left">✓</td>
<td align="left">✓</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><span class="math inline">\({\psi}^T F\)</span></td>
<td align="left">✓</td>
<td align="left">✓</td>
<td align="left">✓<span class="math inline">\(^2\)</span>
</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(^1\)</span> Short-term metrics do not use
linear algebra solvers. Instead, they calculate the results directly in
a loop. This is the same regardless of whether a direct or an iterative
solver is used. It will not necessarily have the same performance
characteristics as the long-term metrics.</p>
<p><span class="math inline">\(^2\)</span> The number of iterations or
steps to convergence for the long-term metrics under the convolution
method depends on the input data. A hard limit of 1,000,000 iterations
is implemented, and if reached, a warning will be issued to indicate
that the results may not have fully converged.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Andrew Marx.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
