<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Maze Part 3 â€¢ samc</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Maze Part 3">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">samc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/article-circuit-theory.html">Circuit Theory</a></li>
    <li><a class="dropdown-item" href="../articles/article-computation-methods.html">Computation Methods</a></li>
    <li><a class="dropdown-item" href="../articles/article-models.html">Models</a></li>
    <li><a class="dropdown-item" href="../articles/performance.html">Performance</a></li>
    <li><a class="dropdown-item" href="../articles/parallel.html">Parallel Computing</a></li>
    <li><a class="dropdown-item" href="../articles/troubleshooting.html">Troubleshooting</a></li>
    <li><a class="dropdown-item" href="../articles/code-snippets.html">Code Snippets</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-data" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Data</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-data">
<li><a class="dropdown-item" href="../articles/data-disconnected.html">Disconnected Data</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../articles/tutorial-basic.html">Basic Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-locations.html">Locations</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-ggplot.html">ggplot Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-temporal.html">Temporal Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-animations.html">Animations</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-multiple-absorption.html">Multiple Absorption</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><a class="dropdown-item" href="../articles/example-coinflip.html">Coin Flip</a></li>
    <li><a class="dropdown-item" href="../articles/example-maze-part1.html">Maze (Part 1)</a></li>
    <li><a class="dropdown-item" href="../articles/example-maze-part2.html">Maze (Part 2)</a></li>
    <li><a class="dropdown-item" href="../articles/example-maze-part3.html">Maze (Part 3)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/andrewmarx/samc"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Maze Part 3</h1>
                        <h4 data-toc-skip class="author">Andrew
Marx</h4>
            
            <h4 data-toc-skip class="date">2024-10-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/andrewmarx/samc/blob/HEAD/vignettes/example-maze-part3.Rmd" class="external-link"><code>vignettes/example-maze-part3.Rmd</code></a></small>
      <div class="d-none name"><code>example-maze-part3.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The third part of the series takes the perfect maze with only a
single solution and modifies it so that it now has more than one
solution. Afterward, all of the changes introduced in the series are
combined into a single complex example.</p>
<p>The complete code for this series is available on <a href="https://github.com/andrewmarx/samc/blob/main/vignettes/scripts/example-maze.R" class="external-link">Github</a>.</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Part 3 reuses the code from <a href="example-maze-part2.html">Part
1</a> and <a href="example-maze-part2.html">Part 2</a>.</p>
</div>
<div class="section level2">
<h2 id="shortcut">Shortcut<a class="anchor" aria-label="anchor" href="#shortcut"></a>
</h2>
<p>To start, the original maze will be modified so that it has a new
cell bridging previously existing cells. The location was chosen so that
it effectively acts as a shortcut to the previous solution. To make
things more interesting, it will be treated as a secret passage by
giving it a high resistance value so that it is only rarely utilized.
This is effectively the same method used to model dead-end avoidance in
Part 2, but here the interpretation is different because of where the
high resistance is located.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a copy and add a shortcut</span></span>
<span><span class="va">short_res</span> <span class="op">&lt;-</span> <span class="va">maze_res</span></span>
<span><span class="va">short_res</span><span class="op">[</span><span class="fl">16</span>, <span class="fl">6</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="co"># Get info about the shortest path through the new maze using gdistance</span></span>
<span><span class="va">lcd2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/xyCellFrom.html" class="external-link">xyFromCell</a></span><span class="op">(</span><span class="va">short_res</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">400</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://AgrDataSci.github.io/gdistance/reference/transition.html" class="external-link">transition</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="va">short_res</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="va">tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://AgrDataSci.github.io/gdistance/reference/geoCorrection.html" class="external-link">geoCorrection</a></span><span class="op">(</span><span class="va">tr</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dist <span class="op">=</span> <span class="fu">gdistance</span><span class="fu">::</span><span class="fu"><a href="https://AgrDataSci.github.io/gdistance/reference/costDistance-methods.html" class="external-link">costDistance</a></span><span class="op">(</span><span class="va">tr</span>, <span class="va">points</span><span class="op">)</span>,</span>
<span>       path <span class="op">=</span> <span class="fu"><a href="https://AgrDataSci.github.io/gdistance/reference/shortestPath.html" class="external-link">shortestPath</a></span><span class="op">(</span><span class="va">tr</span>, <span class="va">points</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, <span class="va">points</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span>, output<span class="op">=</span><span class="st">"SpatialLines"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">plot_maze</span><span class="op">(</span><span class="va">short_res</span>, <span class="st">"Shortcut Maze"</span>, <span class="va">vir_col</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">lcd2</span><span class="op">$</span><span class="va">path</span>, col <span class="op">=</span> <span class="va">vir_col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lw <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="example-maze-part3_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Use <code>gdistance</code> to quickly verify the change in distance
for the shortest solution:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Let's see what the difference in distance is</span></span>
<span><span class="va">lcd2</span><span class="op">$</span><span class="va">dist</span> <span class="op">-</span> <span class="va">lcd</span><span class="op">$</span><span class="va">dist</span></span>
<span><span class="co">#&gt;    1</span></span>
<span><span class="co">#&gt; 2 -9</span></span></code></pre></div>
<p>Since the structure of the resistance input has changed, the
absorption input also has to be changed so that it has the same
structure:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Our old absorption layer does not quite match our new resistance layer, so make a new one</span></span>
<span><span class="va">short_finish</span> <span class="op">&lt;-</span> <span class="va">short_res</span> <span class="op">*</span> <span class="fl">0</span></span>
<span><span class="va">short_finish</span><span class="op">[</span><span class="fl">20</span>, <span class="fl">20</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></code></pre></div>
<p>With new resistance and absorption inputs, the samc object has to be
recreated:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">short_samc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/samc.html">samc</a></span><span class="op">(</span><span class="va">short_res</span>, <span class="va">short_finish</span>, model <span class="op">=</span> <span class="va">rw_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Important: we have to rerun locate()</span></span>
<span><span class="va">short_origin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/locate.html">locate</a></span><span class="op">(</span><span class="va">short_samc</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">short_dest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/locate.html">locate</a></span><span class="op">(</span><span class="va">short_samc</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">20</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>An important thing to keep in mind: modifying where <code>NA</code>
and non-<code>NA</code> cells are located in the map means that previous
results from <code><a href="../reference/locate.html">locate()</a></code> are no longer guaranteed to be valid.
In this case, <code>start</code> is technically the same, but
<code>finish</code> is not and will return incorrect results, or in
special cases even lead to a crash.</p>
<p>With that, letâ€™s begin exploring the different metrics and compare
them to the results from Part 1. Starting with
<code><a href="../reference/survival.html">survival()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">short_surv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.html">survival</a></span><span class="op">(</span><span class="va">short_samc</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot_maze</span><span class="op">(</span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">short_samc</span>, <span class="va">short_surv</span><span class="op">)</span>, <span class="st">"Expected time to finish (Shortcut Maze)"</span>, <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="example-maze-part3_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></p>
<p>There are two noticeable changes. First, the expected time to finish
is drastically decreased for the starting point:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Expected time to finish from the start</span></span>
<span><span class="va">short_surv</span><span class="op">[</span><span class="va">maze_origin</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 9022.974</span></span>
<span></span>
<span><span class="co"># The difference from our original maze</span></span>
<span><span class="va">short_surv</span><span class="op">[</span><span class="va">maze_origin</span><span class="op">]</span> <span class="op">-</span> <span class="va">maze_surv</span><span class="op">[</span><span class="va">maze_origin</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] -4846.026</span></span></code></pre></div>
<p>The second change is the overall increase in expected time to finish
when an individual is in the bottom left region of the maze because the
shortcut can lead them away from the finish point when they are in this
region. If the shortcut was asymmetric (i.e., one way), there would
still be a drastic decrease in the time to finish for the starting
point, but then the bottom left region would remain unchanged from the
original maze. This type of model setup is possible with the package,
but not without directly providing the P matrix. Graph support in the
future will make more complex scenarios like a one-way shortcut easier
to set up.</p>
<p>Part 2 showed that the inclusion of additional absorbing states
changes the relationship between <code><a href="../reference/survival.html">survival()</a></code> and
<code><a href="../reference/cond_passage.html">cond_passage()</a></code>. Since this example is back to a single
absorbing state at the finish point, this relationship is restored:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">short_cond</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cond_passage.html">cond_passage</a></span><span class="op">(</span><span class="va">short_samc</span>, dest <span class="op">=</span> <span class="va">short_dest</span><span class="op">)</span></span>
<span><span class="va">short_cond</span><span class="op">[</span><span class="va">maze_origin</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 9021.974</span></span></code></pre></div>
<p>Part 2 also showed that including additional absorbing states affects
the probability of cells being visited. Modifying the maze to have
multiple routes also has significant ramifications:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">short_disp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dispersal.html">dispersal</a></span><span class="op">(</span><span class="va">short_samc</span>, origin <span class="op">=</span> <span class="va">short_origin</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cached diagonal not found.</span></span>
<span><span class="co">#&gt; Performing setup. This can take several minutes... Complete.</span></span>
<span><span class="co">#&gt; Calculating matrix inverse diagonal...</span></span>
<span><span class="co">#&gt; Computing: 100% (done)                         </span></span>
<span><span class="co">#&gt; Complete                                                      </span></span>
<span><span class="co">#&gt; Diagonal has been cached. Continuing with metric calculation...</span></span>
<span></span>
<span><span class="fu">plot_maze</span><span class="op">(</span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">short_samc</span>, <span class="va">short_disp</span><span class="op">)</span>, <span class="st">"Probability of Visit (Shortcut Maze)"</span>, <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="example-maze-part3_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Notably, it is again no longer possible to discern the optimal route
through the maze by looking for cells with a probability of
<code>1.0</code>. But, like Part 2, a partial path can still be
identified:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ideally, we would just use `as.numeric(short_disp == 1)`, but we have floating point precision issues here, so we will approximate it</span></span>
<span><span class="va">short_disp_sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">short_disp</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">tolerance</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot_maze</span><span class="op">(</span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">short_samc</span>, <span class="va">short_disp_sol</span><span class="op">)</span>, <span class="st">"Partial solution (Shortcut Maze)"</span>, <span class="va">vir_col</span><span class="op">)</span></span></code></pre></div>
<p><img src="example-maze-part3_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
<p>In this case, the result contains the solution for the regions before
and after the loop created by the shortcut.</p>
</div>
<div class="section level2">
<h2 id="combined-example">Combined Example<a class="anchor" aria-label="anchor" href="#combined-example"></a>
</h2>
<p>So far, a variety of changes to the original maze have been
independently explored. Now, many of them will be combined into a more
complex model. First, the resistance and absorption inputs need to be
updated:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combine our previous resistance layers</span></span>
<span><span class="va">all_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">short_res</span>, <span class="va">ints_res</span>, <span class="va">ends_res</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For absorption, all we need is an updated version of our traps raster</span></span>
<span><span class="va">all_traps</span> <span class="op">&lt;-</span> <span class="va">maze_traps</span></span>
<span><span class="va">all_traps</span><span class="op">[</span><span class="fl">16</span>, <span class="fl">6</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Total absorption</span></span>
<span><span class="va">all_abs_total</span> <span class="op">&lt;-</span> <span class="va">short_finish</span> <span class="op">+</span> <span class="va">all_traps</span></span>
<span></span>
<span></span>
<span><span class="co"># If we had more variety in our resistance values we would want more colors</span></span>
<span><span class="fu">plot_maze</span><span class="op">(</span><span class="va">all_res</span>, <span class="st">"Final Maze"</span>, <span class="va">vir_col</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the traps raster</span></span>
<span><span class="fu">plot_maze</span><span class="op">(</span><span class="va">all_traps</span>, <span class="st">"Final Maze Traps"</span>, <span class="va">vir_col</span><span class="op">)</span></span></code></pre></div>
<p><img src="example-maze-part3_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"><img src="example-maze-part3_files/figure-html/unnamed-chunk-11-2.png" width="672" style="display: block; margin: auto;"></p>
<p>There is an unusual artifact present in our new resistance raster:
our shortcut leads into a former dead end, and the dead end resistance
value will increase the probability of the individual turning around in
the shortcut even though, from the perspective of the shortcut, it is
not a dead end. However, when approaching from the bottom, the dead end
still exists if we assume the shortcut is hidden. This is a case where
having asymmetric transition probabilities would be a more ideal
solution, but for simplicity, we will leave things as they are.</p>
<p>Create the new samc object:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_samc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/samc.html">samc</a></span><span class="op">(</span><span class="va">all_res</span>, <span class="va">all_abs_total</span>, model <span class="op">=</span> <span class="va">rw_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We can actually reuse the short_res locations in this case, but let's make new ones anyway</span></span>
<span><span class="va">all_start</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/locate.html">locate</a></span><span class="op">(</span><span class="va">all_samc</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">all_finish</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/locate.html">locate</a></span><span class="op">(</span><span class="va">all_samc</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">20</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Following the previous model changes, start by looking at the
expected time to absorption:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_surv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.html">survival</a></span><span class="op">(</span><span class="va">all_samc</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Note the updated title from part 1</span></span>
<span><span class="fu">plot_maze</span><span class="op">(</span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">all_samc</span>, <span class="va">all_surv</span><span class="op">)</span>, <span class="st">"Expected Time to Absorption"</span>, <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="example-maze-part3_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Similar to Part 2, the presence of additional absorbing states (the
traps), drastically changes the result and interpretation of the
<code><a href="../reference/survival.html">survival()</a></code> metric. The results are very similar to part 2,
but the presence of a shortcut does increase access to both the bottom
left trap and the finish point. The relative role of each isnâ€™t clear,
but it does overall seem to decrease the time to absorption.</p>
<p>Next is a complete overview of the different results for
<code><a href="../reference/survival.html">survival()</a></code> and <code><a href="../reference/cond_passage.html">cond_passage()</a></code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Original results (Part 1)</span></span>
<span><span class="fu"><a href="../reference/survival.html">survival</a></span><span class="op">(</span><span class="va">maze_samc</span><span class="op">)</span><span class="op">[</span><span class="va">maze_origin</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 13869</span></span>
<span><span class="fu"><a href="../reference/cond_passage.html">cond_passage</a></span><span class="op">(</span><span class="va">maze_samc</span>, origin <span class="op">=</span> <span class="va">maze_origin</span>, dest <span class="op">=</span> <span class="va">maze_dest</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 13868</span></span>
<span></span>
<span><span class="co"># Results with traps (Part 2)</span></span>
<span><span class="fu"><a href="../reference/survival.html">survival</a></span><span class="op">(</span><span class="va">traps_samc</span><span class="op">)</span><span class="op">[</span><span class="va">maze_origin</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 1330.26</span></span>
<span><span class="fu"><a href="../reference/cond_passage.html">cond_passage</a></span><span class="op">(</span><span class="va">traps_samc</span>, origin <span class="op">=</span> <span class="va">maze_origin</span>, dest <span class="op">=</span> <span class="va">maze_dest</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3060.207</span></span>
<span></span>
<span><span class="co"># Results with a shortcut</span></span>
<span><span class="fu"><a href="../reference/survival.html">survival</a></span><span class="op">(</span><span class="va">short_samc</span><span class="op">)</span><span class="op">[</span><span class="va">short_origin</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 9022.974</span></span>
<span><span class="fu"><a href="../reference/cond_passage.html">cond_passage</a></span><span class="op">(</span><span class="va">short_samc</span>, origin <span class="op">=</span> <span class="va">short_origin</span>, dest <span class="op">=</span> <span class="va">short_dest</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 9021.974</span></span>
<span></span>
<span><span class="co"># Results with everything</span></span>
<span><span class="fu"><a href="../reference/survival.html">survival</a></span><span class="op">(</span><span class="va">all_samc</span><span class="op">)</span><span class="op">[</span><span class="va">all_start</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 968.4007</span></span>
<span><span class="fu"><a href="../reference/cond_passage.html">cond_passage</a></span><span class="op">(</span><span class="va">all_samc</span>, origin <span class="op">=</span> <span class="va">all_start</span>, dest <span class="op">=</span> <span class="va">all_finish</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2000.364</span></span></code></pre></div>
<p>The presence of both the traps and the shortcut has a cumulative
effect on both metrics; the time to absorption decreases, as does the
time to conditional first passage (the time to finish assuming the
individual is not absorbed elsewhere).</p>
<p>Comparing the traps-only version of the maze to the cumulative maze
using the <code><a href="../reference/mortality.html">mortality()</a></code> metric shows how introducing the
shortcut affects the probability of finishing the maze vs being absorbed
in the traps:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">traps_mort</span><span class="op">[</span><span class="va">traps_mort</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.852084306 0.113761093 0.003940915 0.030213685</span></span>
<span></span>
<span><span class="va">all_mort</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mortality.html">mortality</a></span><span class="op">(</span><span class="va">all_samc</span>, origin <span class="op">=</span> <span class="va">all_start</span><span class="op">)</span></span>
<span><span class="va">all_mort</span><span class="op">[</span><span class="va">all_mort</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.81665446 0.08106988 0.05073905 0.05153661</span></span></code></pre></div>
<p>With the introduction of the shortcut, the probability of absorption
into the two top traps is reduced because less time is spent in the top
portion of the maze relative to the now more accessible bottom portion.
Also, the probability of absorption into the bottom left trap has
increased by more than an order of magnitude, accounting for most of the
decrease in the top two traps. Finally, an individual is somewhat more
likely to survive and finish the maze. Note that the numeric indexes for
the later two points are shifted by one; this is due to changing a
<code>NA</code> cell to non-<code>NA</code> for the shortcut, and it is
related to why the <code><a href="../reference/locate.html">locate()</a></code> should be rerun when the
structure of the input(s) to <code><a href="../reference/samc.html">samc()</a></code> changes.</p>
<p>By now, the process of exploring the different metrics for these
examples should be clear. This example highlighted a few key metrics and
it is left to the user to explore the remaining metrics if they are
interested in doing so. Additionally, this combined example left out the
occupancy and fidelity changes introduced in previous parts; this is
another opportunity for readers to practice making and exploring further
modifications to the model.</p>
</div>
<div class="section level2">
<h2 id="future-work">Future Work<a class="anchor" aria-label="anchor" href="#future-work"></a>
</h2>
<p>Parts of this series may be rewritten, further expanded on, and/or
reorganized in the future. Additionally, when igraph support is added to
the package, the series will be expanded with an example illustrating
the construction of a maze using a graph rather than a
matrix/raster.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrew Marx.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
