<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Coin Flip • samc</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Coin Flip">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">samc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/article-circuit-theory.html">Circuit Theory</a></li>
    <li><a class="dropdown-item" href="../articles/article-computation-methods.html">Computation Methods</a></li>
    <li><a class="dropdown-item" href="../articles/article-models.html">Models</a></li>
    <li><a class="dropdown-item" href="../articles/performance.html">Performance</a></li>
    <li><a class="dropdown-item" href="../articles/parallel.html">Parallel Computing</a></li>
    <li><a class="dropdown-item" href="../articles/troubleshooting.html">Troubleshooting</a></li>
    <li><a class="dropdown-item" href="../articles/code-snippets.html">Code Snippets</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-data" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Data</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-data">
<li><a class="dropdown-item" href="../articles/data-disconnected.html">Disconnected Data</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../articles/tutorial-basic.html">Basic Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-locations.html">Locations</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-ggplot.html">ggplot Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-temporal.html">Temporal Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-animations.html">Animations</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-multiple-absorption.html">Multiple Absorption</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><a class="dropdown-item" href="../articles/example-coinflip.html">Coin Flip</a></li>
    <li><a class="dropdown-item" href="../articles/example-maze-part1.html">Maze (Part 1)</a></li>
    <li><a class="dropdown-item" href="../articles/example-maze-part2.html">Maze (Part 2)</a></li>
    <li><a class="dropdown-item" href="../articles/example-maze-part3.html">Maze (Part 3)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/andrewmarx/samc"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Coin Flip</h1>
                        <h4 data-toc-skip class="author">Andrew
Marx</h4>
            
            <h4 data-toc-skip class="date">2024-10-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/andrewmarx/samc/blob/HEAD/vignettes/example-coinflip.Rmd" class="external-link"><code>vignettes/example-coinflip.Rmd</code></a></small>
      <div class="d-none name"><code>example-coinflip.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This example is a write-up of an answer I gave to a <a href="https://stats.stackexchange.com/questions/553289/could-any-equation-have-predicted-the-results-of-this-simulation" class="external-link">coin
flip question on StackExchange</a>. Essentially, the question was: given
a series of coin flips, how many coin flips would it take (on average)
to get the sequence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi>s</mi><mo>−</mo><mi>T</mi><mi>a</mi><mi>i</mi><mi>l</mi><mi>s</mi><mo>−</mo><mi>H</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">Heads-Tails-Heads</annotation></semantics></math>.</p>
<p>It’s possible to model this scenario using absorbing Markov chains.
Metrics within the package can then be used to answer the posed
question, as well as explore other questions that may be of
interest.</p>
<p>The complete code for this example is available on <a href="https://github.com/andrewmarx/samc/blob/main/vignettes/scripts/example-coinflip.R" class="external-link">Github</a>.</p>
<!--
https://latex.codecogs.com/eqneditor/editor.php
\bordermatrix{
      & HHT & HHH & THT & THH & TTT & TTH & HTT & HTH \cr
  HHT & 0   & 0   & 0   & 0   & 0   & 0   & 1-p & p   \cr
  HHH & 1-p & p   & 0   & 0   & 0   & 0   & 0   & 0   \cr
  THT & 0   & 0   & 0   & 0   & 0   & 0   & 1-p & p   \cr
  THH & 1-p & p   & 0   & 0   & 0   & 0   & 0   & 0   \cr
  TTT & 0   & 0   & 0   & 0   & 1-p & p   & 0   & 0   \cr
  TTH & 0   & 0   & 1-p & p   & 0   & 0   & 0   & 0   \cr
  HTT & 0   & 0   & 0   & 0   & 1-p & p   & 0   & 0   \cr
  HTH & 0   & 0   & 0   & 0   & 0   & 0   & 0   & 1   
}
-->
</div>
<div class="section level2">
<h2 id="libraries">Libraries<a class="anchor" aria-label="anchor" href="#libraries"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://andrewmarx.github.io/samc/" class="external-link">samc</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>The first step is to create a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
matrix representing the possible states. The key is to define
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>T</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">HTH</annotation></semantics></math>
as our absorbing state. In other words, once the model reaches that
state, it is complete.</p>
<p><img src="img/coinflipmatrix.svg"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Coin flip probabilities</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>    <span class="co"># Probability of heads</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">p</span>  <span class="co"># Probability of tails</span></span>
<span></span>
<span><span class="va">p_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">q</span>, <span class="va">p</span>,</span>
<span>                  <span class="va">q</span>, <span class="va">p</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span>
<span>                  <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">q</span>, <span class="va">p</span>,</span>
<span>                  <span class="va">q</span>, <span class="va">p</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span>
<span>                  <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">q</span>, <span class="va">p</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span>
<span>                  <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">q</span>, <span class="va">p</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span>
<span>                  <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">q</span>, <span class="va">p</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span>
<span>                  <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                <span class="fl">8</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">p_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HHT"</span>, <span class="st">"HHH"</span>, <span class="st">"THT"</span>, <span class="st">"THH"</span>, <span class="st">"TTT"</span>, <span class="st">"TTH"</span>, <span class="st">"HTT"</span>, <span class="st">"HTH"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">p_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">p_mat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># A samc object is the core of the package</span></span>
<span><span class="va">samc_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/samc.html">samc</a></span><span class="op">(</span><span class="va">p_mat</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Warning: Some checks for manually created P matrices are still missing:"</span></span>
<span><span class="co">#&gt; [1] "1) Discontinuous data will not work with the cond_passage() function."</span></span>
<span><span class="co">#&gt; [1] "2) Every disconnected region of the graph must have at least one non-zero absorption value."</span></span></code></pre></div>
<p>First, the coin flip probabilities are defined using variables, which
allows us to easily change the matrix to simulate a biased coin if we
want.</p>
<p>The last row and column of the matrix represents
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>T</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">HTH</annotation></semantics></math>,
or the absorbing state. Notice that the last row makes it so that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>T</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">HTH</annotation></semantics></math>
can only transition to itself, and never to a different state. This
construction is explained in the <a href="overview.html#background-1">Overview background</a>.</p>
<p>The remaining rows/columns represent the remaining possible
combinations of 3 coin flips. Technically, this model assumes our
starting point includes a sequence of 3 previous flips. However, if we
decide to use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">TTT</annotation></semantics></math>
as our initial starting point, it will take at least 3 flips to get to
the target sequence, which is no different than starting from an empty
sequence of flips. Contrast this with the sequence of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>H</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">HHT</annotation></semantics></math>,
which only requires one more
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
flip for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>T</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">HTH</annotation></semantics></math>
sequence to occur.</p>
<p>Finally, notice that the rows sum to <code>1</code>, which is
required for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
matrix. This makes sense because each row represents the transition
probabilities for a state. Each state has a 100% probability of doing
<em>something</em>, whether it’s changing to a different transient
state, an absorbing state, or back to the current state.</p>
<p>For the original question, it’s possible to collapse some of these
states and simplify the matrix by only considering the last two coin
flips instead of three. For example,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">HTT</annotation></semantics></math>
would also require a minimum of 3 flips to reach (like
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">TTT</annotation></semantics></math>,
which has the same last two flips), so it could also be used as a
starting point to answer the original question. However, the current
construction simplifies the interpretation a little and allows different
questions to be asked about the model.</p>
<!--
\bordermatrix{
      & HT  & HH  & TT  & TH  & HTH \cr
   HT & 0   & 0   & 1-p & 0^* & p   \cr   *TH and HTH same
   HH & 1-p & p   & 0   & 0   & 0   \cr
   TT & 0   & 0   & 1-p & p   & 0   \cr
   TH & 1-p & p   & 0   & 0   & 0   \cr
  HTH & 0   & 0   & 0   & 0   & 1
}

Could be simplified even further
-->
</div>
<div class="section level2">
<h2 id="metrics">Metrics<a class="anchor" aria-label="anchor" href="#metrics"></a>
</h2>
<p>To answer the original question of how many coin flips it will take,
on average, to see
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>T</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">HTH</annotation></semantics></math>,
all we need to do is calculate the expected time to absorption. With the
samc package, that is accomplished using the <code><a href="../reference/survival.html">survival()</a></code>
function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Given the last 3 flips, how many more flips until we hit HTH (absorption)?</span></span>
<span><span class="fu"><a href="../reference/survival.html">survival</a></span><span class="op">(</span><span class="va">samc_obj</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  6  8  6  8 10  8 10</span></span></code></pre></div>
<p>The fifth element represents
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">TTT</annotation></semantics></math>
and the seventh element represents
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">HTT</annotation></semantics></math>,
or the starting points that do not have progress toward the result. They
both have a value of <code>10</code>, which indicates that it will take
an average of <code>10</code> coin flips with a fair coin to see the
sequence of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>T</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">HTH</annotation></semantics></math>.</p>
<p>The remaining elements give us insight into what would be expected if
we have already made some coin flips with some progress toward the goal.
For example, the first and third elements represent,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>H</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">HHT</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>H</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">THT</annotation></semantics></math>,
which are only one flip away from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>T</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">HTH</annotation></semantics></math>.
As a result, they have the lowest expected averages to completion, which
should intuitively make sense. But they still are relatively high at
<code>6</code> flips expected. Even though there is a 50% probability of
completing the sequence in a single flip, a failure would put us back in
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">HTT</annotation></semantics></math>
state, which is an average of <code>10</code> steps away.</p>
<p>There are other aspects of the model that can be explored using the
package. For example, the <code><a href="../reference/visitation.html">visitation()</a></code> metric calculates
how many times each state is expected to be visited before absorption.
In the context of the coin flip model, this means we can calculate how
many times we expect a sequence to occur before hitting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>T</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">HTH</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Given a starting point (in this case, a sequence of 3 flips), how many times</span></span>
<span><span class="co"># would we expect the different combinations of 3 flips to occur before absorption?</span></span>
<span><span class="fu"><a href="../reference/visitation.html">visitation</a></span><span class="op">(</span><span class="va">samc_obj</span>, origin <span class="op">=</span> <span class="st">"HHT"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.5 0.5 0.5 0.5 1.0 1.0 1.0</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="../reference/visitation.html">visitation</a></span><span class="op">(</span><span class="va">samc_obj</span>, origin <span class="op">=</span> <span class="st">"HHT"</span><span class="op">)</span><span class="op">)</span> <span class="co"># Compare to survival() result</span></span>
<span><span class="co">#&gt; [1] 6</span></span></code></pre></div>
<p>In this case, we specify a starting sequence of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>H</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">HHT</annotation></semantics></math>,
which is one flip away from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>T</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">HTH</annotation></semantics></math>
(absorption). As an example interpretation, with this starting point, we
expect the sequence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>H</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">HHT</annotation></semantics></math>
to occur one and a half times, on average, before hitting the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>T</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">HTH</annotation></semantics></math>
sequence. What’s interesting mathematically is that the sum of these
visitation values is the same as the expected remaining flips before
hitting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>T</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">HTH</annotation></semantics></math>.</p>
<p>Ultimately, the <code><a href="../reference/visitation.html">visitation()</a></code> metric produces a matrix of
all the possible combinations of states and specifying an origin point
simply gives us a single row of the matrix. It’s possible to get
individual columns, as well as the entire matrix (which requires
disabling a safety measure in place for larger problems).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Instead of a start point, we can look at an endpoint and how often we expect</span></span>
<span><span class="co"># it to occur for each of the possible starting points</span></span>
<span><span class="fu"><a href="../reference/visitation.html">visitation</a></span><span class="op">(</span><span class="va">samc_obj</span>, dest <span class="op">=</span> <span class="st">"THT"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.5 0.5 1.5 0.5 1.0 1.0 1.0</span></span>
<span></span>
<span><span class="co"># These results are just rows/cols of a larger matrix. We can get the entire matrix</span></span>
<span><span class="co"># of the start/end possibilities but first, we have to disable some safety measures</span></span>
<span><span class="co"># in place because this package is designed to work with extremely large P matrices</span></span>
<span><span class="co"># (millions of rows/cols) where these types of results will consume too much RAM and</span></span>
<span><span class="co"># crash R</span></span>
<span><span class="va">samc_obj</span><span class="op">$</span><span class="va">override</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="fu"><a href="../reference/visitation.html">visitation</a></span><span class="op">(</span><span class="va">samc_obj</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span></span>
<span><span class="co">#&gt; [1,]  1.5  0.5  0.5  0.5    1    1    1</span></span>
<span><span class="co">#&gt; [2,]  1.5  2.5  0.5  0.5    1    1    1</span></span>
<span><span class="co">#&gt; [3,]  0.5  0.5  1.5  0.5    1    1    1</span></span>
<span><span class="co">#&gt; [4,]  1.5  1.5  0.5  1.5    1    1    1</span></span>
<span><span class="co">#&gt; [5,]  1.0  1.0  1.0  1.0    3    2    1</span></span>
<span><span class="co">#&gt; [6,]  1.0  1.0  1.0  1.0    1    2    1</span></span>
<span><span class="co">#&gt; [7,]  1.0  1.0  1.0  1.0    2    2    2</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="fu"><a href="../reference/visitation.html">visitation</a></span><span class="op">(</span><span class="va">samc_obj</span><span class="op">)</span><span class="op">)</span> <span class="co"># equivalent to survival() above</span></span>
<span><span class="co">#&gt; [1]  6  8  6  8 10  8 10</span></span></code></pre></div>
<p>A third relevant metric is <code><a href="../reference/dispersal.html">dispersal()</a></code>. Rather than the
expected number of times we would expect a coin flip sequence to occur,
it calculates the probability of a sequence occurring before hitting our
target sequence of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>T</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">HTH</annotation></semantics></math>.
The short-term variant can be used to specify a limit to the number of
flips we will make.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dispersal.html">dispersal</a></span><span class="op">(</span><span class="va">samc_obj</span>, dest <span class="op">=</span> <span class="st">"TTT"</span>, time <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.28125 0.21875 0.28125 0.21875 0.00000 0.21875 0.59375</span></span></code></pre></div>
<p>In this case, we’re trying to find the probability of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">TTT</annotation></semantics></math>
occurring within 5 flips. The results show the probability for every
possible starting sequencing. For example, the seventh element,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">HTT</annotation></semantics></math>
is only one flip away and has the highest probability of
<code>0.59375</code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrew Marx.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
