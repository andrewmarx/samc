<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Maze Part 2 • samc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Maze Part 2">
<meta property="og:description" content="samc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">samc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/performance.html">Performance</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Parallel Computing</a>
    </li>
    <li>
      <a href="../articles/troubleshooting.html">Troubleshooting</a>
    </li>
    <li>
      <a href="../articles/code-snippets.html">Code Snippets</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data-disconnected.html">Disconnected Data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tutorial-basic.html">Basic Tutorial</a>
    </li>
    <li>
      <a href="../articles/tutorial-locations.html">Locations</a>
    </li>
    <li>
      <a href="../articles/tutorial-ggplot.html">ggplot Visualization</a>
    </li>
    <li>
      <a href="../articles/tutorial-temporal.html">Temporal Analysis</a>
    </li>
    <li>
      <a href="../articles/tutorial-animations.html">Animations</a>
    </li>
    <li>
      <a href="../articles/tutorial-multiple-absorption.html">Multiple Absorption</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/example-maze-part1.html">Maze (Part 1)</a>
    </li>
    <li>
      <a href="../articles/example-maze-part2.html">Maze (Part 2)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/andrewmarx/samc">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="example-maze-part2_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Maze Part 2</h1>
                        <h4 class="author">Andrew Marx</h4>
            
            <h4 class="date">2021-11-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/andrewmarx/samc/blob/master/vignettes/example-maze-part2.Rmd"><code>vignettes/example-maze-part2.Rmd</code></a></small>
      <div class="hidden name"><code>example-maze-part2.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>In <a href="example-maze-part1.html">Part 1</a> of this series, we explored the applications of absorbing Markov chains in the context of a simple perfect maze. In Part 2, we will expand on our simple maze in various ways and explore how these changes affect our interpretations when using the different metrics offered in the samc package.</p>
</div>
<div id="setup" class="section level2">
<h2 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h2>
<p>This example reuses the <a href="example-maze-part1.html#libraries1">libraries</a>, <a href="example-maze-part1.html#setup1">setup</a>, and original <a href="example-maze-part1.html#create-the-samc-object-1">samc object</a> code from Part 1.</p>
</div>
<div id="fidelity" class="section level2">
<h2 class="hasAnchor">
<a href="#fidelity" class="anchor"></a>Fidelity</h2>
<p>We’ll start by incorporating fidelity into the samc object. In Part 1, transitions always occurred from one cell to a different neighboring cell. With fidelity, we have the ability for transitions to occur from a cell to itself; essentially, there’s no movement over the course of a time step. There are potentially many different ways that fidelity could be applied to the maze, but we’ll keep things simple by using it to create a delay in movement at intersections. The goal will be to model hesitancy when the individual is presented with the choice of three or more paths. For simplicity, we’ll only set the fidelity at all intersections to the same <code>0.1</code> value, which basically means that once an individual is at an intersection, there is a 10% probability that they will stay in the intersection from one time step to the next.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Intersections determined using a moving window function</span>
<span class="va">maze_ints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/focal.html">focal</a></span><span class="op">(</span><span class="va">maze</span>, w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">3</span><span class="op">}</span>, pad <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">maze_ints</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">maze</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="va">maze_ints</span> <span class="op">&lt;-</span> <span class="va">maze_ints</span> <span class="op">*</span> <span class="fl">0.1</span>

<span class="fu">maze_plot</span><span class="op">(</span><span class="va">maze_ints</span>, <span class="st">"Intersections"</span>, <span class="va">vir_col</span><span class="op">)</span></code></pre></div>
<p><img src="example-maze-part2_files/figure-html/unnamed-chunk-1-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Fidelity changes the <span class="math inline">\(P\)</span> matrix underlying the samc object, which means we have to create a new samc object:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">samc_ints</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/samc.html">samc</a></span><span class="op">(</span><span class="va">maze</span>, <span class="va">maze_finish</span>, <span class="va">maze_ints</span>, tr_args <span class="op">=</span> <span class="va">tr</span><span class="op">)</span></code></pre></div>
<p>To start, let’s see how the new fidelity input affects our expected time to finish:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Our original results from Part 1</span>
<span class="fu"><a href="../reference/survival.html">survival</a></span><span class="op">(</span><span class="va">samc_obj</span><span class="op">)</span><span class="op">[</span><span class="va">start</span><span class="op">]</span>
<span class="co">#&gt; [1] 13869</span>
<span class="fu"><a href="../reference/cond_passage.html">cond_passage</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">start</span>, <span class="va">finish</span><span class="op">)</span>
<span class="co">#&gt; [1] 13868</span>

<span class="co"># Our results with fidelity at intersections</span>
<span class="fu"><a href="../reference/survival.html">survival</a></span><span class="op">(</span><span class="va">samc_ints</span><span class="op">)</span><span class="op">[</span><span class="va">start</span><span class="op">]</span>
<span class="co">#&gt; [1] 14356</span>
<span class="fu"><a href="../reference/cond_passage.html">cond_passage</a></span><span class="op">(</span><span class="va">samc_ints</span>, <span class="va">start</span>, <span class="va">finish</span><span class="op">)</span>
<span class="co">#&gt; [1] 14355</span></code></pre></div>
<p>Intuitively, since we’ve added “hesitation” to the movement, the expected time to finish increases. We also see that incorporating fidelity in this particular example does not affect the relationship between <code><a href="../reference/survival.html">survival()</a></code> and <code><a href="../reference/cond_passage.html">cond_passage()</a></code>.</p>
<p>Looking at the probability of visiting any particular cell, changing the fidelity does not change the results from part 1:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">disp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dispersal.html">dispersal</a></span><span class="op">(</span><span class="va">samc_obj</span>, origin <span class="op">=</span> <span class="va">start</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cached diagonal not found.</span>
<span class="co">#&gt; Performing setup. This can take several minutes... Complete.</span>
<span class="co">#&gt; Calculating matrix inverse diagonal...</span>
<span class="co">#&gt; </span>
<span class="va">Complete</span>                                                      
<span class="co">#&gt; Diagonal has been cached. Continuing with metric calculation...</span>
<span class="va">disp_ints</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dispersal.html">dispersal</a></span><span class="op">(</span><span class="va">samc_ints</span>, origin <span class="op">=</span> <span class="va">start</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cached diagonal not found.</span>
<span class="co">#&gt; Performing setup. This can take several minutes... Complete.</span>
<span class="co">#&gt; Calculating matrix inverse diagonal...</span>
<span class="co">#&gt; </span>
<span class="va">Complete</span>                                                      
<span class="co">#&gt; Diagonal has been cached. Continuing with metric calculation...</span>

<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">disp</span>, <span class="va">disp_ints</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>Fidelity does, however, change the number of times each cell is expected to be visited:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">visit_orig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visitation.html">visitation</a></span><span class="op">(</span><span class="va">samc_obj</span>, origin <span class="op">=</span> <span class="va">start</span><span class="op">)</span>
<span class="va">visit_ints</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visitation.html">visitation</a></span><span class="op">(</span><span class="va">samc_ints</span>, origin <span class="op">=</span> <span class="va">start</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">visit_orig</span>, <span class="va">visit_ints</span><span class="op">)</span>
<span class="co">#&gt; [1] "Mean relative difference: 0.03511428"</span>

<span class="co"># Let's plot the difference to see if there is a noticeable pattern</span>
<span class="va">visit_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">visit_ints</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">visit_orig</span><span class="op">)</span>
<span class="fu">maze_plot</span><span class="op">(</span><span class="va">visit_diff</span>, <span class="st">"Visits Per Cell (Difference)"</span>, <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example-maze-part2_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
<p>With fidelity present, the intersections are seeing a significantly different number of visits. Basically, since a “visit” represents a transition to a cell from one time step to the next, the presence of fidelity means that the metric is counting transitions from a cell to itself as well. Interestingly, when compared to the figure in Part 1, the legend in this figure seems to indicate that the increase for the intersections might actually be 10%, or the same as the fidelity probabilities. It also seems like the non-intersections experienced no change. Let’s check these ideas:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># First, let's see which cells changed.</span>
<span class="co"># Ideally, we would just use `visit_diff &gt; 0`, but we have floating point precision issues here, so we will approximate it</span>
<span class="fu">maze_plot</span><span class="op">(</span><span class="va">visit_diff</span> <span class="op">&gt;</span> <span class="va">tolerance</span>, <span class="st">"Visits With Non-Zero Difference"</span>, <span class="va">vir_col</span><span class="op">)</span>

<span class="co"># Second, let's see what the percent change is for our non-zero differences.</span>
<span class="va">visit_perc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">visit_ints</span> <span class="op">-</span> <span class="va">visit_orig</span><span class="op">)</span> <span class="op">/</span> <span class="va">visit_orig</span>
<span class="va">visit_perc</span><span class="op">[</span><span class="va">visit_perc</span><span class="op">&gt;</span><span class="va">tolerance</span><span class="op">]</span>
<span class="co">#&gt;  [1] 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111</span>
<span class="co">#&gt;  [8] 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111</span>
<span class="co">#&gt; [15] 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111</span>
<span class="co">#&gt; [22] 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111</span>
<span class="co">#&gt; [29] 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111</span>
<span class="co">#&gt; [36] 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111</span>
<span class="co">#&gt; [43] 0.1111111</span></code></pre></div>
<p><img src="example-maze-part2_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></p>
<p>It turns out that there is no change in the number of expected visits for non-intersections. It also turns out that our hunch for the intersections was only partially true; the change is constant, but it’s 1/9 instead of 0.1 or 10%.</p>
<p>The most interesting change we might see from incorporating fidelity will be with the <code><a href="../reference/distribution.html">distribution()</a></code> metric. Recall from Part 1 that there was an alternating pattern with the cells when changing the time steps. With fidelity, this effect still exists, but not to the same degree:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dist_ints</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distribution.html">distribution</a></span><span class="op">(</span><span class="va">samc_ints</span>, origin <span class="op">=</span> <span class="va">start</span>, time <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>
<span class="fu">maze_plot</span><span class="op">(</span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_ints</span>, <span class="va">dist_ints</span><span class="op">)</span>, <span class="st">"Location at t=20"</span>, <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span>

<span class="va">dist_ints</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distribution.html">distribution</a></span><span class="op">(</span><span class="va">samc_ints</span>, origin <span class="op">=</span> <span class="va">start</span>, time <span class="op">=</span> <span class="fl">21</span><span class="op">)</span>
<span class="fu">maze_plot</span><span class="op">(</span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_ints</span>, <span class="va">dist_ints</span><span class="op">)</span>, <span class="st">"Location at t=21"</span>, <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example-maze-part2_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"><img src="example-maze-part2_files/figure-html/unnamed-chunk-7-2.png" width="672" style="display: block; margin: auto;"></p>
<p>Given a sufficient amount of time, the cumulative effect of having fidelity present will almost entirely eliminate the alternating pattern. Even from time steps 200-201, the alternating pattern is visually nearly gone:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dist_ints</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distribution.html">distribution</a></span><span class="op">(</span><span class="va">samc_ints</span>, origin <span class="op">=</span> <span class="va">start</span>, time <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>
<span class="fu">maze_plot</span><span class="op">(</span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_ints</span>, <span class="va">dist_ints</span><span class="op">)</span>, <span class="st">"Location at t=200"</span>, <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span>

<span class="va">dist_ints</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distribution.html">distribution</a></span><span class="op">(</span><span class="va">samc_ints</span>, origin <span class="op">=</span> <span class="va">start</span>, time <span class="op">=</span> <span class="fl">201</span><span class="op">)</span>
<span class="fu">maze_plot</span><span class="op">(</span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_ints</span>, <span class="va">dist_ints</span><span class="op">)</span>, <span class="st">"Location at t=201"</span>, <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example-maze-part2_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"><img src="example-maze-part2_files/figure-html/unnamed-chunk-8-2.png" width="672" style="display: block; margin: auto;"></p>
<p>For comparison, here’s the original samc object using the same time steps:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distribution.html">distribution</a></span><span class="op">(</span><span class="va">samc_obj</span>, origin <span class="op">=</span> <span class="va">start</span>, time <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>
<span class="fu">maze_plot</span><span class="op">(</span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">dist</span><span class="op">)</span>, <span class="st">"Location at t=200"</span>, <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span>

<span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distribution.html">distribution</a></span><span class="op">(</span><span class="va">samc_obj</span>, origin <span class="op">=</span> <span class="va">start</span>, time <span class="op">=</span> <span class="fl">201</span><span class="op">)</span>
<span class="fu">maze_plot</span><span class="op">(</span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">dist</span><span class="op">)</span>, <span class="st">"Location at t=201"</span>, <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example-maze-part2_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"><img src="example-maze-part2_files/figure-html/unnamed-chunk-9-2.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="dead-end-avoidance" class="section level2">
<h2 class="hasAnchor">
<a href="#dead-end-avoidance" class="anchor"></a>Dead End Avoidance</h2>
<p>Technically, the package doesn’t offer the ability to “look ahead” at future states to adjust the transition probabilities. In other words, if a route would eventually lead to a dead end, there’s nothing in the <code><a href="../reference/samc.html">samc()</a></code> function or the metric functions to account for that or model the possibility that an individual in the maze can see down a hallway. We can, however, fake it somewhat by adjusting the resistance map so that the dead ends have a much higher resistance. This will reduce the probability of an individual entering a dead end, almost as if they looked ahead. We can use a sliding window function to create this new map:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Dead ends</span>
<span class="va">maze_ends</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/focal.html">focal</a></span><span class="op">(</span><span class="va">maze</span>, w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2</span><span class="op">}</span>, pad <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">maze_ends</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">maze</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="va">maze_ends</span> <span class="op">&lt;-</span> <span class="va">maze_ends</span> <span class="op">*</span> <span class="fl">9</span> <span class="op">+</span> <span class="fl">1</span>
<span class="va">maze_ends</span><span class="op">[</span><span class="fl">20</span>, <span class="fl">20</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="fu">maze_plot</span><span class="op">(</span><span class="va">maze_ends</span>, <span class="st">"Dead Ends"</span>, <span class="va">vir_col</span><span class="op">)</span></code></pre></div>
<p><img src="example-maze-part2_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We have given the dead ends a resistance value of 10, which is relatively high and means that dead ends will only rarely be entered. Since we’ve modified our resistance map, we need to update the samc object. We will not use our fidelity data from the previous section, which will allow us to compare directly against the model created in Part 1.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">samc_ends</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/samc.html">samc</a></span><span class="op">(</span><span class="va">maze_ends</span>, <span class="va">maze_finish</span>, tr_args <span class="op">=</span> <span class="va">tr</span><span class="op">)</span></code></pre></div>
<p>Hypothetically, since an individual can now “look ahead”, they should be able to get through the maze faster because they are spending less time in dead ends. We can see this easily:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Our original results from Part 1</span>
<span class="fu"><a href="../reference/survival.html">survival</a></span><span class="op">(</span><span class="va">samc_obj</span><span class="op">)</span><span class="op">[</span><span class="va">start</span><span class="op">]</span>
<span class="co">#&gt; [1] 13869</span>
<span class="fu"><a href="../reference/cond_passage.html">cond_passage</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">start</span>, <span class="va">finish</span><span class="op">)</span>
<span class="co">#&gt; [1] 13868</span>

<span class="co"># Our results with dead ends</span>
<span class="fu"><a href="../reference/survival.html">survival</a></span><span class="op">(</span><span class="va">samc_ends</span><span class="op">)</span><span class="op">[</span><span class="va">start</span><span class="op">]</span>
<span class="co">#&gt; [1] 11313</span>
<span class="fu"><a href="../reference/cond_passage.html">cond_passage</a></span><span class="op">(</span><span class="va">samc_ends</span>, <span class="va">start</span>, <span class="va">finish</span><span class="op">)</span>
<span class="co">#&gt; [1] 11312</span></code></pre></div>
<p>Since the dead ends have a lower probability of being transitioned to, the <code><a href="../reference/dispersal.html">dispersal()</a></code> and <code><a href="../reference/visitation.html">visitation()</a></code> metrics should obviously reflect that:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">disp_ends</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dispersal.html">dispersal</a></span><span class="op">(</span><span class="va">samc_ends</span>, origin <span class="op">=</span> <span class="va">start</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cached diagonal not found.</span>
<span class="co">#&gt; Performing setup. This can take several minutes... Complete.</span>
<span class="co">#&gt; Calculating matrix inverse diagonal...</span>
<span class="co">#&gt; </span>
<span class="va">Complete</span>                                                      
<span class="co">#&gt; Diagonal has been cached. Continuing with metric calculation...</span>
<span class="fu">maze_plot</span><span class="op">(</span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">disp_ends</span><span class="op">)</span>, <span class="st">"Probability of Visit"</span>, <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span>

<span class="va">visit_ends</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visitation.html">visitation</a></span><span class="op">(</span><span class="va">samc_ends</span>, origin <span class="op">=</span> <span class="va">start</span><span class="op">)</span>
<span class="fu">maze_plot</span><span class="op">(</span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">visit_ends</span><span class="op">)</span>, <span class="st">"Visits Per Cell"</span>, <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example-maze-part2_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;"><img src="example-maze-part2_files/figure-html/unnamed-chunk-13-2.png" width="672" style="display: block; margin: auto;"></p>
<p>The effect is more obvious with <code><a href="../reference/visitation.html">visitation()</a></code> and the expected number of visits; the probability illustration is more subtle compared to the original results in Part 1. This could be explored similarly to how some of the differences in the fidelity section are illustrated, an exercise that will be left to interested readers.</p>
</div>
<div id="traps" class="section level2">
<h2 class="hasAnchor">
<a href="#traps" class="anchor"></a>Traps</h2>
<p>It’s fairly to trivial to add lethal traps to our maze; it just requires updating our absorption input to the <code><a href="../reference/samc.html">samc()</a></code> function. The key thing to keep in mind is that <code><a href="../reference/samc.html">samc()</a></code> expects the total absorption, so we will only be giving it a single absorption input. However, our metrics do allow us to tease apart the role that different sources of absorption will have in the model. There are two different approaches to setting this up:</p>
<ol style="list-style-type: decimal">
<li>We start with a single total absorption input. Then we take that input and decompose it into multiple absorption components.</li>
<li>We start with multiple absorption components. Then we take those inputs and combine them into a single total absorption input.</li>
</ol>
<p>The choice really depends on the data available and the goals of the project. For example, the former strategy is useful if we’ve somehow measured total absorption for a model and want to explore different hypotheses for how it breaks down into different types of absorption. The former is useful if we already have direct knowledge of different sources of absorption. For this example, we’re going with the latter; we already have one absorption component for our finish point, and now we are going to create a second simple one that represents a few traps with a 0.2 or 20% absorption probability:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Traps absorption layer</span>
<span class="va">maze_traps</span> <span class="op">&lt;-</span> <span class="va">maze</span> <span class="op">*</span> <span class="fl">0</span>
<span class="va">maze_traps</span><span class="op">[</span><span class="fl">17</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.2</span>
<span class="va">maze_traps</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">9</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.2</span>
<span class="va">maze_traps</span><span class="op">[</span><span class="fl">6</span>, <span class="fl">20</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.2</span>

<span class="fu">maze_plot</span><span class="op">(</span><span class="va">maze_traps</span>, <span class="st">"Traps"</span>, <span class="va">vir_col</span><span class="op">)</span></code></pre></div>
<p><img src="example-maze-part2_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;"></p>
<p>In order to use this, we will have to create a new samc object:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">abs_total</span> <span class="op">&lt;-</span> <span class="va">maze_finish</span> <span class="op">+</span> <span class="va">maze_traps</span>

<span class="va">samc_traps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/samc.html">samc</a></span><span class="op">(</span><span class="va">maze</span>, <span class="va">abs_total</span>, tr_args <span class="op">=</span> <span class="va">tr</span><span class="op">)</span></code></pre></div>
<p>We’re again only modifying the basic example from Part 1 for easy comparison. Like our other changes, let’s see how long we now expect it to take for an individual to finish the maze:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Our original results from Part 1</span>
<span class="fu"><a href="../reference/survival.html">survival</a></span><span class="op">(</span><span class="va">samc_obj</span><span class="op">)</span><span class="op">[</span><span class="va">start</span><span class="op">]</span>
<span class="co">#&gt; [1] 13869</span>
<span class="fu"><a href="../reference/cond_passage.html">cond_passage</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">start</span>, <span class="va">finish</span><span class="op">)</span>
<span class="co">#&gt; [1] 13868</span>

<span class="co"># Our results with traps</span>
<span class="fu"><a href="../reference/survival.html">survival</a></span><span class="op">(</span><span class="va">samc_traps</span><span class="op">)</span><span class="op">[</span><span class="va">start</span><span class="op">]</span>
<span class="co">#&gt; [1] 1330.26</span>
<span class="fu"><a href="../reference/cond_passage.html">cond_passage</a></span><span class="op">(</span><span class="va">samc_traps</span>, <span class="va">start</span>, <span class="va">finish</span><span class="op">)</span>
<span class="co">#&gt; [1] 3060.207</span></code></pre></div>
<p>The results are drastically different from what we’ve seen before. First, we no longer have the clear relationship between <code><a href="../reference/survival.html">survival()</a></code> and <code><a href="../reference/cond_passage.html">cond_passage()</a></code>. This is because<code><a href="../reference/survival.html">survival()</a></code> no longer gives us information on how long it will take to finish; instead it now tells us long it will take to either finish <em>or</em> die to one of our traps. This also drastically changes what we see when plotting the results of <code><a href="../reference/survival.html">survival()</a></code> (note the change in figure title from Part 1 to reflect the new interpretation):</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">survive_traps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.html">survival</a></span><span class="op">(</span><span class="va">samc_traps</span><span class="op">)</span>

<span class="co"># Note the updated title from part 1</span>
<span class="fu">maze_plot</span><span class="op">(</span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">survive_traps</span><span class="op">)</span>, <span class="st">"Expected Time to Absorption"</span>, <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example-maze-part2_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We also see drastically different results from Part 1 when looking at visitation probability and number of visits:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">disp_traps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dispersal.html">dispersal</a></span><span class="op">(</span><span class="va">samc_traps</span>, origin <span class="op">=</span> <span class="va">start</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cached diagonal not found.</span>
<span class="co">#&gt; Performing setup. This can take several minutes... Complete.</span>
<span class="co">#&gt; Calculating matrix inverse diagonal...</span>
<span class="co">#&gt; </span>
<span class="va">Complete</span>                                                      
<span class="co">#&gt; Diagonal has been cached. Continuing with metric calculation...</span>
<span class="fu">maze_plot</span><span class="op">(</span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_traps</span>, <span class="va">disp_traps</span><span class="op">)</span>, <span class="st">"Probability of Visit"</span>, <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span>

<span class="va">visit_traps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visitation.html">visitation</a></span><span class="op">(</span><span class="va">samc_traps</span>, origin <span class="op">=</span> <span class="va">start</span><span class="op">)</span>
<span class="fu">maze_plot</span><span class="op">(</span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_traps</span>, <span class="va">visit_traps</span><span class="op">)</span>, <span class="st">"Visits Per Cell"</span>, <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example-maze-part2_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;"><img src="example-maze-part2_files/figure-html/unnamed-chunk-18-2.png" width="672" style="display: block; margin: auto;"></p>
<p>Importantly, we can longer use the same technique as Part 1 where we used visitation probabilities of 1.0 to identify the route through the maze; it only works in very specialized cases. The reason is simple: since the individual can now be absorbed in other locations, there is a non-zero probability that they never reach the finish, which in turn means the probability of visiting the finish is now less than 1.0. However, we can still use the same technique to see something interesting:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Ideally, we would just use `as.numeric(disp == 1)`, but we have floating point precision issues here, so we will approximate it</span>
<span class="va">disp_traps_route</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">disp_traps</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">tolerance</span><span class="op">)</span>

<span class="fu">maze_plot</span><span class="op">(</span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_traps</span>, <span class="va">disp_traps_route</span><span class="op">)</span>, <span class="st">"dispersal() == 1"</span>, <span class="va">vir_col</span><span class="op">)</span></code></pre></div>
<p><img src="example-maze-part2_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;"></p>
<p>It shows us part of the solution we saw before, but only up to the first maze intersection that leads to two or more possible sources of absorption.</p>
<p>The inclusion of multiple absorption states now allows us to explore metrics that were not useful of Part 1. Starting with <code><a href="../reference/mortality.html">mortality()</a></code>, we can visualize where we would expect the individual to be absorbed:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mort_traps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mortality.html">mortality</a></span><span class="op">(</span><span class="va">samc_traps</span>, origin <span class="op">=</span> <span class="va">start</span><span class="op">)</span>

<span class="fu">maze_plot</span><span class="op">(</span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_traps</span>, <span class="va">mort_traps</span><span class="op">)</span>, <span class="st">"Absorption Probability"</span>, <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example-maze-part2_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;"></p>
<p>That quite possibly is not what we would have expected. Why does the finish point look like it’s 0? Let’s look at the numbers and see if we can figure it out from there:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mort_traps</span><span class="op">[</span><span class="va">mort_traps</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span>
<span class="co">#&gt;           5          65         170         215 </span>
<span class="co">#&gt; 0.852084306 0.113761093 0.003940915 0.030213685</span>

<span class="va">mort_traps</span><span class="op">[</span><span class="va">finish</span><span class="op">]</span>
<span class="co">#&gt;        215 </span>
<span class="co">#&gt; 0.03021369</span></code></pre></div>
<p>There’s only a 3.0% chance of our individual finishing the maze! This seems really low given our traps are only lethal 20% of the time, but if we stop to think about it, it actually makes sense. Recall the <a href="example-maze-part1.html#probability-of-visiting-a-cell-1">Probability of visiting a cell</a> and <a href="example-maze-part1.html#visits-per-cell-1">Visits per cell</a> sections from Part 1; the individual spends most of their time in the early part of the maze. That means they have a lot more exposure to our first trap and, consequently, are more likely to be absorbed there with a 85.2% probability. If we look at the trap farthest from the start, reaching it first requires passing by the finish, so consequently it has only a 0.39% of being the source of absorption, a substantially lower probability than just finishing the maze.</p>
<p>The package allows us to break things down so that we can investigate the role of different types of mortality more easily. Remember, we started with two absorption layers that we summed together; now that the samc object has been created, we can provide it that information:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Naming our rasters will make things easier and less error-prone later</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span><span class="op">(</span><span class="va">maze_finish</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Finish"</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span><span class="op">(</span><span class="va">maze_traps</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Traps"</span>

<span class="va">samc_traps</span><span class="op">$</span><span class="va">abs_states</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html">stack</a></span><span class="op">(</span><span class="va">maze_finish</span>, <span class="va">maze_traps</span><span class="op">)</span></code></pre></div>
<p>By doing so, the <code><a href="../reference/mortality.html">mortality()</a></code> metric now returns a list with information about not just the total absorption, but the individual components we specified. This allows us to individually access and visualize the role of different types of absorption:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mort_traps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mortality.html">mortality</a></span><span class="op">(</span><span class="va">samc_traps</span>, origin <span class="op">=</span> <span class="va">start</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">mort_traps</span><span class="op">)</span>
<span class="co">#&gt; List of 3</span>
<span class="co">#&gt;  $ total : Named num [1:215] 0 0 0 0 0.852 ...</span>
<span class="co">#&gt;   ..- attr(*, "names")= chr [1:215] "1" "2" "3" "4" ...</span>
<span class="co">#&gt;  $ Finish: Named num [1:215] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..- attr(*, "names")= chr [1:215] "1" "2" "3" "4" ...</span>
<span class="co">#&gt;  $ Traps : Named num [1:215] 0 0 0 0 0.852 ...</span>
<span class="co">#&gt;   ..- attr(*, "names")= chr [1:215] "1" "2" "3" "4" ...</span>

<span class="fu">maze_plot</span><span class="op">(</span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_traps</span>, <span class="va">mort_traps</span><span class="op">$</span><span class="va">Finish</span><span class="op">)</span>, <span class="st">"Absorption Probability (Finish)"</span>, <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span>
<span class="fu">maze_plot</span><span class="op">(</span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_traps</span>, <span class="va">mort_traps</span><span class="op">$</span><span class="va">Traps</span><span class="op">)</span>, <span class="st">"Absorption Probability (Traps)"</span>, <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example-maze-part2_files/figure-html/unnamed-chunk-23-1.png" width="672" style="display: block; margin: auto;"><img src="example-maze-part2_files/figure-html/unnamed-chunk-23-2.png" width="672" style="display: block; margin: auto;"></p>
<p>We can also now make use of the <code><a href="../reference/absorption.html">absorption()</a></code> metric:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/absorption.html">absorption</a></span><span class="op">(</span><span class="va">samc_traps</span>, origin <span class="op">=</span> <span class="va">start</span><span class="op">)</span>
<span class="co">#&gt;     Finish      Traps </span>
<span class="co">#&gt; 0.03021369 0.96978631</span></code></pre></div>
<p>The output from this is quite simple: it tells us the probability that the individual will experience a particular type of absorption. So as we saw before, there is a 3.0% chance of finishing the maze. But now we see that there is a 97.0% total probability that absorption will occur in one of the three traps. This is different from the <code><a href="../reference/mortality.html">mortality()</a></code> metric, which tells us the absorption probabilities at each cell. There’s clearly a relationship between the two metrics, and the advantage of this example is that it’s easy to see it; in more complex examples, it’s more difficult to see how the two metrics are related.</p>
</div>
<div id="part-3" class="section level2">
<h2 class="hasAnchor">
<a href="#part-3" class="anchor"></a>Part 3</h2>
<p>In the next part of this example series we will take our maze with only a single solution and modify it with a “secret” shortcut. We will then take all of the changes we’ve introduced and combine them into a single final example.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Andrew Marx.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
