<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Overview • samc</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Overview">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">samc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/article-circuit-theory.html">Circuit Theory</a></li>
    <li><a class="dropdown-item" href="../articles/article-computation-methods.html">Computation Methods</a></li>
    <li><a class="dropdown-item" href="../articles/article-models.html">Models</a></li>
    <li><a class="dropdown-item" href="../articles/performance.html">Performance</a></li>
    <li><a class="dropdown-item" href="../articles/parallel.html">Parallel Computing</a></li>
    <li><a class="dropdown-item" href="../articles/troubleshooting.html">Troubleshooting</a></li>
    <li><a class="dropdown-item" href="../articles/code-snippets.html">Code Snippets</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-data" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Data</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-data">
<li><a class="dropdown-item" href="../articles/data-disconnected.html">Disconnected Data</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../articles/tutorial-basic.html">Basic Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-locations.html">Locations</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-ggplot.html">ggplot Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-temporal.html">Temporal Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-animations.html">Animations</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-multiple-absorption.html">Multiple Absorption</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><a class="dropdown-item" href="../articles/example-coinflip.html">Coin Flip</a></li>
    <li><a class="dropdown-item" href="../articles/example-maze-part1.html">Maze (Part 1)</a></li>
    <li><a class="dropdown-item" href="../articles/example-maze-part2.html">Maze (Part 2)</a></li>
    <li><a class="dropdown-item" href="../articles/example-maze-part3.html">Maze (Part 3)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/andrewmarx/samc"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Overview</h1>
                        <h4 data-toc-skip class="author">Andrew
Marx</h4>
            
            <h4 data-toc-skip class="date">2024-10-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/andrewmarx/samc/blob/HEAD/vignettes/overview.Rmd" class="external-link"><code>vignettes/overview.Rmd</code></a></small>
      <div class="d-none name"><code>overview.Rmd</code></div>
    </div>

    
    
<div class="section level4">
<h4 id="background">
<strong>Background</strong><a class="anchor" aria-label="anchor" href="#background"></a>
</h4>
<p>This package provides a series of functions for working with
absorbing Markov chains. A Markov chain is a model consisting of
multiple states and describes how transitions occur between these
states. An absorbing Markov chain is a special kind of Markov chain
where every state is a <em>transient state</em> that can eventually
reach one or more <em>absorbing states</em>. Absorbing states are a
special type of state that cannot be left. Absorbing Markov chains can
be represented using a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
matrix with the following structure:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>Q</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>R</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>I</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
P =
\begin{bmatrix}
Q &amp; R \\
0 &amp; I
\end{bmatrix}
</annotation></semantics></math> Where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Q</mi><annotation encoding="application/x-tex">Q</annotation></semantics></math>
is a matrix that describes the probability of transition between
different transient states.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Q</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">Q_{i,j}</annotation></semantics></math>
is the probability of transitioning from transient state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
to transient state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>.
When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i=j</annotation></semantics></math>,
the transition probability is describing the probability that a
transient state stays the same or doesn’t transition to a different
transient state.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
is a matrix that describes the probability of transitioning from a
transient state to an absorbing state.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">R_{i,k}</annotation></semantics></math>
is the probability of transitioning from transient state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
to absorbing state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>
is a matrix filled with zeros. The rows correspond to absorbing states
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>,
and the columns correspond to transient states
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>.
This represents that an absorbing state has a 0% probability of
transitioning to a transient state</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>I</mi><annotation encoding="application/x-tex">I</annotation></semantics></math>
is an identity matrix where each row and column corresponds to the
different absorbing states. The main diagonal is filled with ones, and
everything else is set to zero. This matrix represents that absorbing
state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
has a 100% probability of transitioning to itself (i.e., the state will
never change).</li>
<li>When combined,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>I</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\begin{bmatrix}0 &amp; I\end{bmatrix}</annotation></semantics></math>
represents that once an absorbing state has been entered, it cannot be
left for a transient state or a different absorbing state.</li>
</ul>
</div>
<div class="section level4">
<h4 id="the-samc-class">
<strong>The <code>samc-class</code></strong><a class="anchor" aria-label="anchor" href="#the-samc-class"></a>
</h4>
<p>The <code>samc-class</code> is used to manage the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
matrix and other information to help ensure that the calculations used
by the rest of the package are used correctly. Creating a
<code>samc-class</code> object is the mandatory first step in the
package, and is created using the <code><a href="../reference/samc.html">samc()</a></code> utility function.
When creating the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
matrix, <code><a href="../reference/samc.html">samc()</a></code> only treats the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
matrix portion as a single column containing the total absorption
probability for each transient state. The <code><a href="../reference/samc.html">samc()</a></code> function
has several parameters that provide many different options for
constructing the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
matrix that is at the core of the <code>samc-class</code>.</p>
<div class="section level6">
<h6 id="option-1-maps">
<em>Option 1: Maps</em><a class="anchor" aria-label="anchor" href="#option-1-maps"></a>
</h6>
<p>The first option is to use a map of resistance (or conductance) and a
map of total absorption with a list of transition arguments to calculate
the transition probabilities between cells in the maps. There are
certain requirements for these maps:</p>
<ul>
<li>They must be 2-dimensional matrices, <code>RasterLayer</code>, or
<code>SpatRaster</code> objects. These different types cannot be
mixed.</li>
<li>All inputs must have the same dimensions (number of rows and
columns).</li>
<li>
<code>NA</code> is allowed in the cells, but must match between the
sets of data. I.e., if cell <code>[3, 6]</code> of the
<em>resistance</em> data has a <code>NA</code> value, then cell
<code>[3, 6]</code> of the <em>absorption</em> data must also have a
<code>NA</code> value and vice versa.</li>
</ul>
<p>If using <code>SpatRaster</code> or <code>RasterLayer</code> objects,
then additional conditions must be met:</p>
<ul>
<li>Both sets of data must have the same coordinate extents.</li>
<li>Both sets of data must use the same coordinate reference system
(CRS).</li>
</ul>
<p>An optional fidelity map may be provided. This map would represent
the probability of no transition between timesteps (e.g., no movement).
By default, the package treats all cells in the maps the same and uses a
value of <code>0</code> for fidelity. If used, the fidelity map must
meet all of the same requirements listed above for the other map
inputs.</p>
</div>
<div class="section level6">
<h6 id="option-2-p-matrix">
<em>Option 2: P Matrix</em><a class="anchor" aria-label="anchor" href="#option-2-p-matrix"></a>
</h6>
<p>The second option for using this package is to directly supply a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
matrix. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
matrix can be provided either as a regular matrix or a
<code>dgCmatrix</code>, which is a sparse matrix object available
through the Matrix package. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
portion of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
matrix must be a single column that represents the total absorption
probability for each transient state.</p>
<p>The advantage of this approach is total flexibility. The disadvantage
is that the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
matrix can be created with certain properties that would lead to
crashes, and the package is unable to detect all of them at this time.
The other disadvantage is that the package cannot map the results back
to anything for visualization purposes.</p>
</div>
<div class="section level6">
<h6 id="option-3-igraph">
<em>Option 3: igraph</em><a class="anchor" aria-label="anchor" href="#option-3-igraph"></a>
</h6>
<p>A future version of the package will incorporate igraph support for
graph-based inputs. This will provide the flexibility of a custom
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
matrix, but will generally be more user-friendly to construct, be able
to perform more thorough data checking to avoid issues in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
matrix, and allow for mapping the results back to a graph for
visualization purposes.</p>
</div>
</div>
<div class="section level4">
<h4 id="utility-functions">
<strong>Utility Functions</strong><a class="anchor" aria-label="anchor" href="#utility-functions"></a>
</h4>
<p>In addition to the <code><a href="../reference/samc.html">samc()</a></code> function, the package has
other utility functions that users might find helpful:</p>
<ul>
<li>The <code><a href="../reference/check.html">check()</a></code> function is used to check that input map
data meets the data requirements outlined above. It can be used to
compare two <code>SpatRaster</code> objects, two
<code>RasterLayer</code> objects, two <code>matrix</code> objects, or
check either a <code>SpatRaster</code>, <code>RasterLayer</code>, or a
<code>matrix</code> against an already created <code>samc-class</code>
object. It can also be used with a multilayer <code>SpatRaster</code> or
a <code>RasterStack</code> to check all the layers in the stack against
one another.</li>
<li>The <code><a href="../reference/map.html">map()</a></code> function is used to simplify mapping vector
results based on input maps and returns a object with the same data type
that was used to create the <code>samc-class</code> object. This is
provided because R handles matrices and raster layers somewhat
differently when reading and writing vector data, which can cause users
to map the data incorrectly if they aren’t careful. It also handles
mapping with <code>NA</code> values, another potential source of
error.</li>
<li>The <code><a href="../reference/locate.html">locate()</a></code> function is used to get cell numbers for
use as <code>origin</code> and <code>dest</code> values in various
analytical function arguments. This function should be used instead of
<code><a href="https://rspatial.github.io/terra/reference/xyCellFrom.html" class="external-link">cellFromXY()</a></code> in the raster or terra packages because
<code><a href="https://rspatial.github.io/terra/reference/xyCellFrom.html" class="external-link">cellFromXY()</a></code> cell numbers do not necessarily correspond to
cell numbers in the samc package (the samc package does not assign cell
numbers to <code>NA</code> cells, whereas other packages do). The
<code><a href="../reference/locate.html">locate()</a></code> function can be used to return a map with the cell
numbers encoded as cell values by simply excluding the <code>xy</code>
argument. In this case, the map will have the same class type as the
inputs to <code><a href="../reference/samc.html">samc()</a></code>
</li>
<li>The <code><a href="../reference/pairwise.html">pairwise()</a></code> function is provided to easily and
efficiently run specific metrics for all the pairwise combinations of
start and end locations.</li>
</ul>
</div>
<div class="section level4">
<h4 id="analytical-functions">
<strong>Analytical Functions</strong><a class="anchor" aria-label="anchor" href="#analytical-functions"></a>
</h4>
<p>The package implements functions for the formulas provided in Table 1
of Fletcher et al. (2019), as well as other new ones since that
publication. Many of the formulas are related conceptually and are
grouped into single functions with multiple parameter signatures to
reduce the number of unique function names needed. Note that the
descriptions assume
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
contains probabilities (see above). The following descriptions were
written in an ecological context; the function reference pages provide
mathematically formal descriptions.</p>
<table class="table">
<colgroup>
<col width="30%">
<col width="30%">
<col width="39%">
</colgroup>
<thead><tr class="header">
<th align="left">Function</th>
<th align="left">Equation</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code><a href="../reference/absorption.html">absorption()</a></code></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi>F</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">A = F R</annotation></semantics></math></td>
<td align="left">Probability of an individual experiencing a specific
type of mortality</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ψ</mi><mi>T</mi></msup><mi>A</mi></mrow><annotation encoding="application/x-tex">\psi^T A</annotation></semantics></math></td>
<td align="left">Probability of an individual experiencing a specific
type of mortality, given an initial state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="../reference/cond_passage.html">cond_passage()</a></code></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>t</mi><mo accent="true">̃</mo></mover><mo>=</mo><msubsup><mover><mi>B</mi><mo accent="true">̃</mo></mover><mi>j</mi><mrow><mi>−</mi><mn>1</mn></mrow></msubsup><mover><mi>F</mi><mo accent="true">̃</mo></mover><msub><mover><mi>B</mi><mo accent="true">̃</mo></mover><mi>j</mi></msub><mo>⋅</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\tilde{t} = \tilde{B}_j^{-1}\tilde{F}\tilde{B}_j{\cdot}1</annotation></semantics></math></td>
<td align="left">Mean first conditional passage time</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/dispersal.html">dispersal()</a></code></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>D</mi><mo accent="true">̃</mo></mover><mrow><mi>j</mi><mi>t</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msup><mover><mi>Q</mi><mo accent="true">̃</mo></mover><mi>n</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><msub><mover><mi>q</mi><mo accent="true">̃</mo></mover><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\tilde{D}_{jt}=({\sum}_{n=0}^{t-1}\tilde{Q}^n)\tilde{q}_j</annotation></semantics></math></td>
<td align="left">Probability of an individual visiting a location, if
starting at any other location, before or at time <em>t</em>
</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ψ</mi><mi>T</mi></msup><msub><mover><mi>D</mi><mo accent="true">̃</mo></mover><mrow><mi>j</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\psi^T\tilde{D}_{jt}</annotation></semantics></math></td>
<td align="left">Probability of an individual visiting a location,
before or at time <em>t</em>, given an initial state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>F</mi><mo>−</mo><mi>I</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>F</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>−</mi><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">D=(F-I)diag(F)^{-1}</annotation></semantics></math></td>
<td align="left">Probability of an individual visiting a location</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ψ</mi><mi>T</mi></msup><mi>D</mi></mrow><annotation encoding="application/x-tex">\psi^TD</annotation></semantics></math></td>
<td align="left">Probability of an individual visiting a location, given
an initial state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/distribution.html">distribution()</a></code></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Q</mi><mi>t</mi></msup><annotation encoding="application/x-tex">Q^t</annotation></semantics></math></td>
<td align="left">Probability of an individual being at a location at
time <em>t</em>
</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ψ</mi><mi>T</mi></msup><msup><mi>Q</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">\psi^TQ^t</annotation></semantics></math></td>
<td align="left">Probability of an individual being at a location at
time <em>t</em>, given an initial state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/mortality.html">mortality()</a></code></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>B</mi><mo accent="true">̃</mo></mover><mi>t</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msup><mi>Q</mi><mi>n</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mover><mi>R</mi><mo accent="true">̃</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{B}_t = (\sum_{n=0}^{t-1} Q^n) \tilde{R}</annotation></semantics></math></td>
<td align="left">Probability of an individual experiencing mortality at
a location before or at time <em>t</em>
</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ψ</mi><mi>T</mi></msup><msub><mover><mi>B</mi><mo accent="true">̃</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\psi^T \tilde{B}_t</annotation></semantics></math></td>
<td align="left">Probability of an individual experiencing mortality at
a location, before or at time <em>t</em>, given an initial state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mi>F</mi><mover><mi>R</mi><mo accent="true">̃</mo></mover></mrow><annotation encoding="application/x-tex">B = F \tilde{R}</annotation></semantics></math></td>
<td align="left">Probability of an individual experiencing mortality at
a location</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ψ</mi><mi>T</mi></msup><mi>B</mi></mrow><annotation encoding="application/x-tex">\psi^T B</annotation></semantics></math></td>
<td align="left">Probability of an individual experiencing mortality at
a location, given an initial state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/survival.html">survival()</a></code></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo>−</mo><mi>Q</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>−</mi><mn>1</mn></mrow></msup><mo>⋅</mo><mn>1</mn><mo>=</mo><mi>F</mi><mo>⋅</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">z=(I-Q)^{-1}{\cdot}1=F{\cdot}1</annotation></semantics></math></td>
<td align="left">Expected life expectancy of an individual</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ψ</mi><mi>T</mi></msup><mi>z</mi></mrow><annotation encoding="application/x-tex">{\psi}^Tz</annotation></semantics></math></td>
<td align="left">Overall life expectancy, given an initial state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/visitation.html">visitation()</a></code></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>F</mi><mo accent="true">̃</mo></mover><mi>t</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msup><mi>Q</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">\tilde{F}_t = \sum_{n=0}^{t-1} Q^n</annotation></semantics></math></td>
<td align="left">Expected number of times an individual visits a
location before or at time <em>t</em>
</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ψ</mi><mi>T</mi></msup><msub><mover><mi>F</mi><mo accent="true">̃</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\psi}^T \tilde{F}_t</annotation></semantics></math></td>
<td align="left">Expected number of times an individual visits a
location before or at time <em>t</em>, given an initial state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo>−</mo><mi>Q</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>−</mi><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">F = (I-Q)^{-1}</annotation></semantics></math></td>
<td align="left">Expected number of times an individual visits a
location</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ψ</mi><mi>T</mi></msup><mi>F</mi></mrow><annotation encoding="application/x-tex">{\psi}^T F</annotation></semantics></math></td>
<td align="left">Expected number of times an individual visits a
location, given an initial state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
<p>Depending on the combination of inputs used, a function might return
a single value, a vector, a matrix, or a list. In some cases, the
calculations will be impractical with sufficiently large landscape
datasets due to memory and other performance constraints. To work around
this, many equations have multiple associated function signatures that
allow users to calculate individual portions of the result rather than
the entire result. This opens up multiple optimizations that make
calculating many of the metrics more practical. More specific details
about performance considerations can be found in the Performance
vignette.</p>
</div>
<div class="section level4">
<h4 id="initial-state-data">Initial State Data<a class="anchor" aria-label="anchor" href="#initial-state-data"></a>
</h4>
<p>Several of the analytical functions allow the input of an initial
state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
for the Markov chain via the <code>init</code> parameter. The
descriptions for these analytical functions assume that values in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
sum to one. When this is the case,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ψ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\psi_i</annotation></semantics></math>
represents the probability that the Markov chain starts in transient
state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.</p>
<p>When the values in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
sum to a value other than one, care must be taken in the interpretation
of the results. For example,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
could be used to represent a population of individuals where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ψ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\psi_i</annotation></semantics></math>
represents the number of individuals that start in transient state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
In this case, the results of the functions using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
aren’t probabilities, but rather the expected number of individuals.</p>
</div>
<div class="section level4">
<h4 id="built-in-example-data">
<strong>Built-in Example Data</strong><a class="anchor" aria-label="anchor" href="#built-in-example-data"></a>
</h4>
<p>The package includes built-in example map data. Some of this data was
used to create the figures in the SAMC paper and is used in numerous
package tutorials.</p>
<ul>
<li>
<code>example_split_corridor</code>: A list with three matrices
<ul>
<li>
<code>res</code>: A matrix with landscape resistance data.</li>
<li>
<code>abs</code>: A matrix with landscape absorption (mortality)
data.</li>
<li>
<code>init</code>: A matrix with initial starting locations.</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu">samc</span><span class="fu">::</span><span class="va"><a href="../reference/example_split_corridor.html">example_split_corridor</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ res : num [1:34, 1:202] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">#&gt;  $ abs : num [1:34, 1:202] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">#&gt;  $ init: num [1:34, 1:202] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span></span>
<span><span class="va">res_data</span> <span class="op">&lt;-</span> <span class="fu">samc</span><span class="fu">::</span><span class="va"><a href="../reference/example_split_corridor.html">example_split_corridor</a></span><span class="op">$</span><span class="va">res</span></span>
<span><span class="va">abs_data</span> <span class="op">&lt;-</span> <span class="fu">samc</span><span class="fu">::</span><span class="va"><a href="../reference/example_split_corridor.html">example_split_corridor</a></span><span class="op">$</span><span class="va">abs</span></span>
<span><span class="va">init_data</span> <span class="op">&lt;-</span> <span class="fu">samc</span><span class="fu">::</span><span class="va"><a href="../reference/example_split_corridor.html">example_split_corridor</a></span><span class="op">$</span><span class="va">init</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/rasterize.html">rasterize</a></span><span class="op">(</span><span class="va">res_data</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Example Resistance Data"</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"y"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/rasterize.html">rasterize</a></span><span class="op">(</span><span class="va">abs_data</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Example Absorption Data"</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"y"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/rasterize.html">rasterize</a></span><span class="op">(</span><span class="va">init_data</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Example Starting Location Data"</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"y"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-1-1.png" width="700"><img src="overview_files/figure-html/unnamed-chunk-1-2.png" width="700"><img src="overview_files/figure-html/unnamed-chunk-1-3.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrew Marx.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
