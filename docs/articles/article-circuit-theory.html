<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Circuit Theory • samc</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Circuit Theory">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">samc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/article-circuit-theory.html">Circuit Theory</a></li>
    <li><a class="dropdown-item" href="../articles/article-computation-methods.html">Computation Methods</a></li>
    <li><a class="dropdown-item" href="../articles/article-models.html">Models</a></li>
    <li><a class="dropdown-item" href="../articles/performance.html">Performance</a></li>
    <li><a class="dropdown-item" href="../articles/parallel.html">Parallel Computing</a></li>
    <li><a class="dropdown-item" href="../articles/troubleshooting.html">Troubleshooting</a></li>
    <li><a class="dropdown-item" href="../articles/code-snippets.html">Code Snippets</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-data" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Data</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-data">
<li><a class="dropdown-item" href="../articles/data-disconnected.html">Disconnected Data</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../articles/tutorial-basic.html">Basic Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-locations.html">Locations</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-ggplot.html">ggplot Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-temporal.html">Temporal Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-animations.html">Animations</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-multiple-absorption.html">Multiple Absorption</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><a class="dropdown-item" href="../articles/example-coinflip.html">Coin Flip</a></li>
    <li><a class="dropdown-item" href="../articles/example-maze-part1.html">Maze (Part 1)</a></li>
    <li><a class="dropdown-item" href="../articles/example-maze-part2.html">Maze (Part 2)</a></li>
    <li><a class="dropdown-item" href="../articles/example-maze-part3.html">Maze (Part 3)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/andrewmarx/samc"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Circuit Theory</h1>
                        <h4 data-toc-skip class="author">Andrew
Marx</h4>
            
            <h4 data-toc-skip class="date">2024-10-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/andrewmarx/samc/blob/HEAD/vignettes/article-circuit-theory.Rmd" class="external-link"><code>vignettes/article-circuit-theory.Rmd</code></a></small>
      <div class="d-none name"><code>article-circuit-theory.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>This document describes the relationship between the samc package and
circuit theory, as presented in an article published in Methods in
Ecology and Evolution (2022; DOI: <a href="https://doi.org/10.1111/2041-210X.13975" class="external-link">10.1111/2041-210X.13975</a>)
and at a workshop during the 2021 International Association for
Landscape Ecology - North American annual meeting: <a href="https://www.ialena.org/workshops-2021.html" class="external-link">IALE-NA 2021
Workshops</a>.</p>
<p>Circuit theory (McRae et al. 2008) is a widely used tool in ecology
and conservation for modeling landscape connectivity. It can be used to
calculate several different metrics, including:</p>
<ul>
<li>Commute time or resistance distance</li>
<li>Net flow from one node to another</li>
<li>Probability of reaching nodes</li>
</ul>
<p>Both SAMC and circuit theory use Markov chain theory to model
movement based on variations in the landscape coded as resistance
values. However, SAMC extends these capabilities by utilizing absorbing
Markov chains, which allow it to model a variety of short- and long-term
metrics. SAMC also allows for explicitly incorporating multiple
absorption states into the model. These states can represent any effect
that might permanently stop movement in the landscape, such as:</p>
<ul>
<li>Natural death</li>
<li>Predation probability</li>
<li>Disease risk</li>
<li>Human removal</li>
<li>Non-mortality causes (e.g., permanent settlement)</li>
</ul>
</div>
<div class="section level2">
<h2 id="code-setup">Code Setup<a class="anchor" aria-label="anchor" href="#code-setup"></a>
</h2>
<p>This section is for loading the packages and creating objects used in
the examples. The resistance data has two low-resistance routes between
the source and destinations. The absorption data has no background
absorption, but does have a narrow strip of strong absorption that runs
across most of the map, but not across the left route. This is the same
example data used in the IALE workshop, where the absorption data was
used to describe a hypothetical highway with a safe crossing area for
the left route.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://rspatial.org/" class="external-link">"terra"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://rspatial.org/raster" class="external-link">"raster"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://AgrDataSci.github.io/gdistance/" class="external-link">"gdistance"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://andrewmarx.github.io/samc/" class="external-link">"samc"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://sjmgarnier.github.io/viridisLite/" class="external-link">"viridisLite"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a landscape with two paths around an obstacle</span></span>
<span><span class="co"># This is the same </span></span>
<span><span class="va">res_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,   <span class="fl">10</span>,   <span class="fl">10</span>,    <span class="fl">5</span>,    <span class="fl">5</span>,   <span class="fl">10</span>,   <span class="fl">10</span>,    <span class="fl">10</span>,</span>
<span>                    <span class="fl">20</span>,   <span class="fl">20</span>,   <span class="fl">10</span>,   <span class="fl">10</span>,   <span class="fl">10</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">10</span>,</span>
<span>                    <span class="fl">10</span>,   <span class="fl">10</span>,   <span class="fl">10</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,     <span class="fl">5</span>,</span>
<span>                    <span class="fl">10</span>,   <span class="fl">10</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,   <span class="fl">20</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,   <span class="fl">10</span>,    <span class="fl">10</span>,</span>
<span>                     <span class="fl">5</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,     <span class="fl">5</span>,</span>
<span>                    <span class="fl">10</span>,    <span class="fl">1</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,     <span class="fl">2</span>,</span>
<span>                    <span class="fl">10</span>,    <span class="fl">1</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,    <span class="fl">2</span>,    <span class="fl">2</span>,    <span class="fl">1</span>,     <span class="fl">1</span>,</span>
<span>                    <span class="fl">20</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,   <span class="fl">10</span>,   <span class="fl">10</span>,   <span class="fl">10</span>,    <span class="fl">2</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,     <span class="fl">1</span>,</span>
<span>                    <span class="fl">20</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">2</span>,     <span class="fl">2</span>,</span>
<span>                    <span class="fl">10</span>,   <span class="fl">10</span>,   <span class="fl">10</span>,   <span class="fl">10</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">5</span>,    <span class="fl">5</span>,    <span class="fl">5</span>,     <span class="fl">5</span><span class="op">)</span>,</span>
<span>                  nrow <span class="op">=</span> <span class="fl">10</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">abs_data</span> <span class="op">=</span> <span class="va">res_data</span> <span class="op">*</span> <span class="fl">0</span> <span class="co"># Create a baseline mortality or absorption level. To experiment with background mortality rates, add a small number to this (e.g., `+ 0.0001`)</span></span>
<span><span class="va">abs_data</span><span class="op">[</span><span class="fl">6</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0.1</span> <span class="co"># Create a "highway" with high absorption and a safe crossing point</span></span>
<span><span class="va">abs_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">res_data</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="va">res_data</span> <span class="op">=</span> <span class="fu">samc</span><span class="fu">::</span><span class="fu"><a href="../reference/rasterize.html">rasterize</a></span><span class="op">(</span><span class="va">res_data</span><span class="op">)</span></span>
<span><span class="va">abs_data</span> <span class="op">=</span> <span class="fu">samc</span><span class="fu">::</span><span class="fu"><a href="../reference/rasterize.html">rasterize</a></span><span class="op">(</span><span class="va">abs_data</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_data</span>, main <span class="op">=</span> <span class="st">"Example Resistance Data"</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"y"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">abs_data</span>, main <span class="op">=</span> <span class="st">"Example Absorption Data"</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"y"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rw_model</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, dir <span class="op">=</span> <span class="fl">8</span>, sym <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">samc_obj</span> <span class="op">=</span> <span class="fu"><a href="../reference/samc.html">samc</a></span><span class="op">(</span><span class="va">res_data</span>, <span class="va">abs_data</span>, model <span class="op">=</span> <span class="va">rw_model</span><span class="op">)</span></span>
<span></span>
<span><span class="va">origin_coords</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dest_coords</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">9</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">origin_cell</span> <span class="op">=</span> <span class="fu"><a href="../reference/locate.html">locate</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">origin_coords</span><span class="op">)</span></span>
<span><span class="va">dest_cell</span> <span class="op">=</span> <span class="fu"><a href="../reference/locate.html">locate</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">dest_coords</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gdist</span> <span class="op">=</span> <span class="fu"><a href="https://AgrDataSci.github.io/gdistance/reference/transition.html" class="external-link">transition</a></span><span class="op">(</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="va">res_data</span><span class="op">)</span>, <span class="va">rw_model</span><span class="op">$</span><span class="va">fun</span>, <span class="va">rw_model</span><span class="op">$</span><span class="va">dir</span><span class="op">)</span></span>
<span><span class="va">gdist</span> <span class="op">=</span> <span class="fu"><a href="https://AgrDataSci.github.io/gdistance/reference/geoCorrection.html" class="external-link">geoCorrection</a></span><span class="op">(</span><span class="va">gdist</span><span class="op">)</span></span></code></pre></div>
<p><img src="article-circuit-theory_files/figure-html/unnamed-chunk-1-1.png" width="672" style="display: block; margin: auto;"><img src="article-circuit-theory_files/figure-html/unnamed-chunk-1-2.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="commute-time-and-hitting-time">Commute Time and Hitting Time<a class="anchor" aria-label="anchor" href="#commute-time-and-hitting-time"></a>
</h2>
<p><strong>Commute time</strong> (sometimes referred to as
<strong>commute distance</strong>), is the expected length of time, or
the number of steps, it takes to go from one node to another and back in
a graph using a random walk. In circuit theory, commute time is
proportional to the resistance distance between two nodes (Chandra et
al., 1997). This measure is bidirectional; it is the sum of going from
one node to another and back. Let us refer to commute time as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">C_{ij}</annotation></semantics></math>
is the commute time from node
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
to node
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
and then back to node
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.</p>
<p><strong>Hitting time</strong>, or <strong>first passage
time</strong>, is the expected time, or the number of steps, it takes to
go from one node to another using a random walk. This measure is
unidirectional; it only accounts for going from one node to another, but
<em>not</em> back. The hitting times may not be equal for different
directions between two nodes depending on the situation. Let us refer to
hitting time using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">H_{ij}</annotation></semantics></math>
is the hitting time from node
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
to node
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">H_{ji}</annotation></semantics></math>
is the hitting time from node
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
to node
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">H_{ij}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">H_{ij}</annotation></semantics></math>
may or may not be equal.</p>
<p>Given these definitions, the sum of the two hitting times between two
nodes is the same as the commute time between the two nodes. That is,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>H</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>H</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{ij}=H_{ij}+H_{ji}</annotation></semantics></math>.</p>
<p>Circuit theory can be used to calculate the commute time between two
points via tools like Circuitscape (indirectly from resistance outputs)
or the gdistance R package (directly with the
<code><a href="https://AgrDataSci.github.io/gdistance/reference/commuteDistance-methods.html" class="external-link">commuteDistance()</a></code> function). In the SAMC, it can be
calculated by adding the hitting times in both directions. There are two
ways in which hitting times can be calculated with SAMC.</p>
<p>The first (limited) approach to calculating hitting times via SAMC is
with the <code><a href="../reference/survival.html">survival()</a></code> metric. This requires creating two
<code>samc</code> objects (one for each direction between two nodes). To
do so, the only non-zero absorption value needs to be at the destination
node
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
depending on the direction). As long as absorption only occurs at the
destination node and has an absorption probability of <code>1</code>,
the <code><a href="../reference/survival.html">survival()</a></code> function will calculate the first passage
time to that node. Applying the <code><a href="../reference/survival.html">survival()</a></code> function to both
samc objects and summing the results will provide the commute time. This
approach is limited because it does not broadly allow for variation in
absorption; graphs with absorption occurring outside the destination
nodes
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>)
require an alternative approach.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Absorption only at the origin i</span></span>
<span><span class="va">abs_data_i</span> <span class="op">=</span> <span class="va">res_data</span> <span class="op">*</span> <span class="fl">0</span></span>
<span><span class="va">abs_data_i</span><span class="op">[</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/xyCellFrom.html" class="external-link">cellFromXY</a></span><span class="op">(</span><span class="va">res_data</span>, <span class="va">origin_coords</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">abs_data_i</span>, main <span class="op">=</span> <span class="st">"Source Absorption Map"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Absorption only at the destination j</span></span>
<span><span class="va">abs_data_j</span> <span class="op">=</span> <span class="va">res_data</span> <span class="op">*</span> <span class="fl">0</span></span>
<span><span class="va">abs_data_j</span><span class="op">[</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/xyCellFrom.html" class="external-link">cellFromXY</a></span><span class="op">(</span><span class="va">res_data</span>, <span class="va">dest_coords</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">abs_data_j</span>, main <span class="op">=</span> <span class="st">"Destination Absorption Map"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="article-circuit-theory_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;"><img src="article-circuit-theory_files/figure-html/unnamed-chunk-2-2.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create samc objects for each direction</span></span>
<span><span class="va">samc_ij</span> <span class="op">=</span> <span class="fu"><a href="../reference/samc.html">samc</a></span><span class="op">(</span><span class="va">res_data</span>, <span class="va">abs_data_j</span>, model <span class="op">=</span> <span class="va">rw_model</span><span class="op">)</span></span>
<span><span class="va">samc_ji</span> <span class="op">=</span> <span class="fu"><a href="../reference/samc.html">samc</a></span><span class="op">(</span><span class="va">res_data</span>, <span class="va">abs_data_i</span>, model <span class="op">=</span> <span class="va">rw_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate commute distance with samc</span></span>
<span><span class="va">hitting_ij</span> <span class="op">=</span> <span class="fu"><a href="../reference/survival.html">survival</a></span><span class="op">(</span><span class="va">samc_ij</span>, <span class="va">abs_data_i</span><span class="op">)</span> <span class="co"># Reusing the other abs layer as an occupancy input</span></span>
<span><span class="va">hitting_ji</span> <span class="op">=</span> <span class="fu"><a href="../reference/survival.html">survival</a></span><span class="op">(</span><span class="va">samc_ji</span>, <span class="va">abs_data_j</span><span class="op">)</span> <span class="co"># Reusing the other abs layer as an occupancy input</span></span>
<span></span>
<span><span class="va">hitting_ij</span></span>
<span><span class="co">#&gt; [1] 210.222</span></span>
<span><span class="va">hitting_ji</span></span>
<span><span class="co">#&gt; [1] 293.0998</span></span>
<span><span class="va">hitting_ij</span> <span class="op">+</span> <span class="va">hitting_ji</span></span>
<span><span class="co">#&gt; [1] 503.3218</span></span>
<span></span>
<span><span class="co"># Calculate commute distance with gdistance</span></span>
<span><span class="fu"><a href="https://AgrDataSci.github.io/gdistance/reference/commuteDistance-methods.html" class="external-link">commuteDistance</a></span><span class="op">(</span><span class="va">gdist</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">origin_coords</span>, <span class="va">dest_coords</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;          1</span></span>
<span><span class="co">#&gt; 2 501.3218</span></span></code></pre></div>
<p>There are a few key things to note here. First, the two commute
distance results are slightly different. This is because SAMC is
calculating the time to reach the destination plus one additional time
step for absorption. In circuit theory, these two transitions are not
considered separately; that is, reaching the destination is equivalent
to going to the ground state (absorption). This occurs twice (once in
each direction), which causes SAMC to have a commute distance that is
<code>2</code> time steps higher than what gdistance calculates.</p>
<p>The second thing to note is that the two hitting times produced by
SAMC are also slightly different. In other words, movement in one
direction between the two points is not equivalent to movement in the
other direction. This extra information about the total commute distance
can be useful in a real-world scenario. For example, gene flow between
two populations may be different in both directions. In this case, the
hitting times, rather than commute distance, may result in better models
comparing gene flow to landscape connectivity.</p>
<p>The second and more flexible approach in SAMC is the
<code><a href="../reference/cond_passage.html">cond_passage()</a></code> function, which directly calculates the
“conditional” first passage time in graphs where absorption can occur
anywhere. It is “conditional” because it only considers possible paths
through the graph where the destination node is reached. In other words,
when absorption is possible anywhere, there will be scenarios where the
destination is never reached, and these scenarios have to be excluded
for the calculation to work.</p>
<p><code><a href="../reference/cond_passage.html">cond_passage()</a></code> can be used in the same way described for
the <code><a href="../reference/survival.html">survival()</a></code> metric previously, in which case an
equivalent result to commute distance from circuit theory will be
obtained. Unlike the <code><a href="../reference/survival.html">survival()</a></code> function, the result of
<code><a href="../reference/cond_passage.html">cond_passage()</a></code> does not include the extra absorption time
step; it only calculates the time to reach the destination.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hitting_ij_cp</span> <span class="op">=</span> <span class="fu"><a href="../reference/cond_passage.html">cond_passage</a></span><span class="op">(</span><span class="va">samc_ij</span>, origin <span class="op">=</span> <span class="va">origin_cell</span>, dest <span class="op">=</span> <span class="va">dest_cell</span><span class="op">)</span></span>
<span><span class="va">hitting_ji_cp</span> <span class="op">=</span> <span class="fu"><a href="../reference/cond_passage.html">cond_passage</a></span><span class="op">(</span><span class="va">samc_ji</span>, origin <span class="op">=</span> <span class="va">dest_cell</span>, dest <span class="op">=</span> <span class="va">origin_cell</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hitting_ij_cp</span></span>
<span><span class="co">#&gt; [1] 209.222</span></span>
<span><span class="va">hitting_ji_cp</span></span>
<span><span class="co">#&gt; [1] 292.0998</span></span>
<span><span class="va">hitting_ij_cp</span> <span class="op">+</span> <span class="va">hitting_ji_cp</span></span>
<span><span class="co">#&gt; [1] 501.3218</span></span></code></pre></div>
<p>More importantly, this is just a special case where we demonstrate
the relationship between circuit theory and SAMC. For more generic
scenarios, only a single normal <code>samc</code> object is required for
calculating the hitting times:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate hitting times and commute distance for the original absorption data</span></span>
<span><span class="va">reg_hitting_ij</span> <span class="op">=</span> <span class="fu"><a href="../reference/cond_passage.html">cond_passage</a></span><span class="op">(</span><span class="va">samc_obj</span>, origin <span class="op">=</span> <span class="va">origin_cell</span>, dest <span class="op">=</span> <span class="va">dest_cell</span><span class="op">)</span></span>
<span><span class="va">reg_hitting_ji</span> <span class="op">=</span> <span class="fu"><a href="../reference/cond_passage.html">cond_passage</a></span><span class="op">(</span><span class="va">samc_obj</span>, origin <span class="op">=</span> <span class="va">dest_cell</span>, dest <span class="op">=</span> <span class="va">origin_cell</span><span class="op">)</span></span>
<span></span>
<span><span class="va">reg_hitting_ij</span></span>
<span><span class="co">#&gt; [1] 128.2726</span></span>
<span><span class="va">reg_hitting_ji</span></span>
<span><span class="co">#&gt; [1] 127.6531</span></span>
<span><span class="va">reg_hitting_ij</span> <span class="op">+</span> <span class="va">reg_hitting_ji</span></span>
<span><span class="co">#&gt; [1] 255.9258</span></span></code></pre></div>
<p>In this case, the resulting commute distance is much lower because
absorption occurs throughout the landscape. In the simplified scenario,
a lack of absorption (except for the destination) means that all
possible movement paths will eventually reach the destination. In
contrast, with landscape absorption, we now have scenarios where some of
those same movement paths are absorbed before reaching the destination.
Since those removed paths tended to be longer, their removal caused the
overall commute time to decrease.</p>
<p>To think about this, consider a landscape without any absorption. In
this scenario, individuals will continuously move around forever. This
leads to infinitely long paths. Once absorption is incorporated into the
landscape, the probability of these infinitely long paths occurring
decreases. As the overall probability of absorption in the landscape
increases, the overall probability of infinitely long paths occurring
will decrease. That is what happens when we switch from a circuit theory
model with only a single ground node (effectively a single absorption
point) to a SAMC model that allows absorption anywhere; the probability
of individuals existing indefinitely in the landscape will decrease, and
ideally, model a more realistic scenario.</p>
<p>Consider this in the context of dispersal and gene flow;
realistically, an individual dispersing from one population might never
make it to another population. For example, they might die along the
way. As a result, they would not contribute to gene flow between the two
populations in this case. SAMC provides a mechanism to account for this
possibility via the <code><a href="../reference/cond_passage.html">cond_passage()</a></code> function and the
incorporation of absorption more broadly.</p>
</div>
<div class="section level2">
<h2 id="net-and-total-movement-flow">Net and Total Movement Flow<a class="anchor" aria-label="anchor" href="#net-and-total-movement-flow"></a>
</h2>
<p>One application of circuit theory is the construction of current maps
that describe the net movement from one node to another. There is an
essential distinction between <strong>net</strong> and
<strong>total</strong> movement flow here; <strong>net</strong> movement
is the difference between movement flows in opposite directions, whereas
<strong>total</strong> movement is the sum of the movement flows in
opposite directions. These “current” flow maps are commonly used to
identify movement corridors and pinch points that may occur in
landscapes.</p>
<p>Current maps produced by Circuitscape model the net flow, and the
gdistance package can model both with the <code><a href="https://AgrDataSci.github.io/gdistance/reference/passage.html" class="external-link">passage()</a></code>
function. The <code>samc</code> package can calculate the total movement
directly using the <code><a href="../reference/visitation.html">visitation()</a></code> metric and the net movement
flow using the <code><a href="../reference/visitation_net.html">visitation_net()</a></code> function. To get equivalent
results between gdistance and SAMC, we must again disregard absorption
outside the destination.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Total movement flow with gdistance</span></span>
<span><span class="va">total_gdist</span> <span class="op">=</span> <span class="fu"><a href="https://AgrDataSci.github.io/gdistance/reference/passage.html" class="external-link">passage</a></span><span class="op">(</span><span class="va">gdist</span>, <span class="va">origin_coords</span>, <span class="va">dest_coords</span>, theta <span class="op">=</span> <span class="fl">0</span>, totalNet <span class="op">=</span> <span class="st">"total"</span><span class="op">)</span></span>
<span><span class="va">total_gdist_ras</span> <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">total_gdist</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">total_gdist_ras</span>, main <span class="op">=</span> <span class="st">"Total Movement Flow (gdistance)"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Equivalent total movement flow with SAMC</span></span>
<span><span class="va">total_samc</span> <span class="op">=</span> <span class="fu"><a href="../reference/visitation.html">visitation</a></span><span class="op">(</span><span class="va">samc_ij</span>, origin <span class="op">=</span> <span class="va">origin_cell</span><span class="op">)</span></span>
<span><span class="va">total_samc_ras</span> <span class="op">=</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_ij</span>, <span class="va">total_samc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">total_samc_ras</span>, main <span class="op">=</span> <span class="st">"Total Movement Flow (samc)"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verify that they have the same values</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">total_gdist_ras</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">total_samc_ras</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># Net movement flow with gdistance</span></span>
<span><span class="va">net_gdist</span> <span class="op">=</span> <span class="fu"><a href="https://AgrDataSci.github.io/gdistance/reference/passage.html" class="external-link">passage</a></span><span class="op">(</span><span class="va">gdist</span>, <span class="va">origin_coords</span>, <span class="va">dest_coords</span>, theta <span class="op">=</span> <span class="fl">0</span>, totalNet <span class="op">=</span> <span class="st">"net"</span><span class="op">)</span></span>
<span><span class="va">net_gdist_ras</span> <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">net_gdist</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">net_gdist_ras</span>, main <span class="op">=</span> <span class="st">"Net Movement Flow (gdistance)"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Equivalent net movement flow with SAMC</span></span>
<span><span class="va">net_samc</span> <span class="op">=</span> <span class="fu"><a href="../reference/visitation_net.html">visitation_net</a></span><span class="op">(</span><span class="va">samc_ij</span>, origin <span class="op">=</span> <span class="va">origin_cell</span><span class="op">)</span></span>
<span><span class="va">net_samc_ras</span> <span class="op">=</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_ij</span>, <span class="va">net_samc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">net_samc_ras</span>,  main <span class="op">=</span> <span class="st">"Net Movement Flow (samc)"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verify that they have the same values</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">net_gdist_ras</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">net_samc_ras</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p><img src="article-circuit-theory_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"><img src="article-circuit-theory_files/figure-html/unnamed-chunk-6-2.png" width="672" style="display: block; margin: auto;"><img src="article-circuit-theory_files/figure-html/unnamed-chunk-6-3.png" width="672" style="display: block; margin: auto;"><img src="article-circuit-theory_files/figure-html/unnamed-chunk-6-4.png" width="672" style="display: block; margin: auto;"></p>
<p>As with commute distance, SAMC is not limited to calculating the
total and net movement flows for landscapes without absorption.
<code><a href="../reference/visitation.html">visitation()</a></code> and <code><a href="../reference/visitation_net.html">visitation_net()</a></code> are
perfectly valid for our original samc object with broader landscape
absorption. Here is an example where we combine the destination
absorption point with the absorbing barrier:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comb_abs</span> <span class="op">=</span> <span class="va">abs_data_j</span> <span class="op">+</span> <span class="va">abs_data</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">comb_abs</span>,  main <span class="op">=</span> <span class="st">"Combined absorption"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">samc_comb</span> <span class="op">=</span> <span class="fu"><a href="../reference/samc.html">samc</a></span><span class="op">(</span><span class="va">res_data</span>, <span class="va">comb_abs</span>, model <span class="op">=</span> <span class="va">rw_model</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">comb_net</span> <span class="op">=</span> <span class="fu"><a href="../reference/visitation_net.html">visitation_net</a></span><span class="op">(</span><span class="va">samc_comb</span>, origin <span class="op">=</span> <span class="va">origin_cell</span><span class="op">)</span></span>
<span><span class="va">comb_net_res</span> <span class="op">=</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_comb</span>, <span class="va">comb_net</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">comb_net_res</span>,  main <span class="op">=</span> <span class="st">"Net Movement Flow (samc with combined absorption)"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="article-circuit-theory_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"><img src="article-circuit-theory_files/figure-html/unnamed-chunk-7-2.png" width="672" style="display: block; margin: auto;"></p>
<p>Incorporating absorption more broadly has reduced the net movement
flow between our start and end points because now the destination is not
guaranteed to be reached, leading to a dramatic drop in the net movement
at the destination cell. We can subtract the non-absorption model from
the absorption model to see how much net movement flow has
decreased.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comb_net_diff</span> <span class="op">=</span> <span class="va">comb_net_res</span> <span class="op">-</span> <span class="va">net_gdist_ras</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">comb_net_diff</span>, main <span class="op">=</span> <span class="st">"Effect of Combined Absorption on Net Movement Flow"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bin for easier interpretation</span></span>
<span><span class="va">comb_net_diff_binned</span> <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">classify</a></span><span class="op">(</span><span class="va">comb_net_diff</span>, rcl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.01</span>, <span class="fl">0</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span>, right <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">comb_net_diff_binned</span>, main <span class="op">=</span> <span class="st">"Effect of Combined Absorption on Net Movement Flow (Binned)"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="article-circuit-theory_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"><img src="article-circuit-theory_files/figure-html/unnamed-chunk-8-2.png" width="672" style="display: block; margin: auto;"></p>
<p>Overall, we see that net flow has increased on the bottom half and
decreased on the top half. Intuitively, net flow in the top half is
reduced because the barrier is absorbing some of the flow coming from
below. The increase in net flow in the bottom half may be less
intuitive, but occurs because movement that would have been originally
reached the top half is now partially being absorbed in both directions.
So since there is less movement from the top half into the bottom half,
that means the net flow in the bottom half is less affected by that
return flow.</p>
<p>We also see that movement flow on the right path becomes
significantly restricted by the absorption barrier, making the left path
relatively more important for movement flow from the start to the end.
Yet, despite an opening in the barrier, we still see a noticeable drop
in flow in the left path. Finally, we can see a substantial decrease in
the net movement flow reaching the destination. We can look at the
values directly to see that reduction is over 98%:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">net_samc_ras</span><span class="op">[</span><span class="va">dest_cell</span><span class="op">]</span> <span class="co"># Net movement flow at destination w/o absorption</span></span>
<span><span class="co">#&gt;   lyr.1</span></span>
<span><span class="co">#&gt; 1     1</span></span>
<span><span class="va">comb_net</span><span class="op">[</span><span class="va">dest_cell</span><span class="op">]</span> <span class="co"># With absorption</span></span>
<span><span class="co">#&gt; [1] 0.4571945</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrew Marx.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
