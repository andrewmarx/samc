<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Circuit Theory • samc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Circuit Theory">
<meta property="og:description" content="samc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">samc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/article-circuit-theory.html">Circuit Theory</a>
    </li>
    <li>
      <a href="../articles/article-computation-methods.html">Computation Methods</a>
    </li>
    <li>
      <a href="../articles/article-models.html">Models</a>
    </li>
    <li>
      <a href="../articles/performance.html">Performance</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Parallel Computing</a>
    </li>
    <li>
      <a href="../articles/troubleshooting.html">Troubleshooting</a>
    </li>
    <li>
      <a href="../articles/code-snippets.html">Code Snippets</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data-disconnected.html">Disconnected Data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tutorial-basic.html">Basic Tutorial</a>
    </li>
    <li>
      <a href="../articles/tutorial-locations.html">Locations</a>
    </li>
    <li>
      <a href="../articles/tutorial-ggplot.html">ggplot Visualization</a>
    </li>
    <li>
      <a href="../articles/tutorial-temporal.html">Temporal Analysis</a>
    </li>
    <li>
      <a href="../articles/tutorial-animations.html">Animations</a>
    </li>
    <li>
      <a href="../articles/tutorial-multiple-absorption.html">Multiple Absorption</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/example-coinflip.html">Coin Flip</a>
    </li>
    <li>
      <a href="../articles/example-maze-part1.html">Maze (Part 1)</a>
    </li>
    <li>
      <a href="../articles/example-maze-part2.html">Maze (Part 2)</a>
    </li>
    <li>
      <a href="../articles/example-maze-part3.html">Maze (Part 3)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/andrewmarx/samc" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Circuit Theory</h1>
                        <h4 data-toc-skip class="author">Andrew
Marx</h4>
            
            <h4 data-toc-skip class="date">2023-04-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/andrewmarx/samc/blob/HEAD/vignettes/article-circuit-theory.Rmd" class="external-link"><code>vignettes/article-circuit-theory.Rmd</code></a></small>
      <div class="hidden name"><code>article-circuit-theory.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>This document describes the relationship between the samc package and
circuit theory, as presented in an article published in Methods in
Ecology and Evolution (2022; DOI: <a href="https://doi.org/10.1111/2041-210X.13975" class="external-link">10.1111/2041-210X.13975</a>)
and at a workshop during the 2021 International Association for
Landscape Ecology - North American annual meeting: <a href="https://www.ialena.org/workshops-2021.html" class="external-link">IALE-NA 2021
Workshops</a>.</p>
<p>Circuit theory (McRae et al. 2008) is a widely used tool in ecology
and conservation for modeling landscape connectivity. It can be used to
calculate several different metrics, including:</p>
<ul>
<li>Commute time or resistance distance</li>
<li>Net flow from one node to another</li>
<li>Probability of reaching nodes</li>
</ul>
<p>Both SAMC and circuit theory use Markov chain theory to model
movement based on variations in the landscape coded as resistance
values. However, SAMC extends these capabilities by utilizing absorbing
Markov chains, which allow it to model a variety of short- and long-term
metrics. SAMC also allows for explicitly incorporating multiple
absorption states into the model. These states can represent any effect
that might permanently stop movement in the landscape, such as:</p>
<ul>
<li>Natural death</li>
<li>Predation probability</li>
<li>Disease risk</li>
<li>Human removal</li>
<li>Non-mortality causes (e.g., permanent settlement)</li>
</ul>
</div>
<div class="section level2">
<h2 id="code-setup">Code Setup<a class="anchor" aria-label="anchor" href="#code-setup"></a>
</h2>
<p>This section is for loading the packages and creating objects used in
the examples. The resistance data has two low-resistance routes between
the source and destinations. The absorption data has no background
absorption, but does have a narrow strip of strong absorption that runs
across most of the map, but not across the left route. This is the same
example data used in the IALE workshop, where the absorption data was
used to describe a hypothetical highway with a safe crossing area for
the left route.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://rspatial.org/terra/" class="external-link">"terra"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://rspatial.org/raster" class="external-link">"raster"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://AgrDataSci.github.io/gdistance/" class="external-link">"gdistance"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://andrewmarx.github.io/samc/" class="external-link">"samc"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://sjmgarnier.github.io/viridisLite/" class="external-link">"viridisLite"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a landscape with two paths around an obstacle</span></span>
<span><span class="co"># This is the same </span></span>
<span><span class="va">res_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,   <span class="fl">10</span>,   <span class="fl">10</span>,    <span class="fl">5</span>,    <span class="fl">5</span>,   <span class="fl">10</span>,   <span class="fl">10</span>,    <span class="fl">10</span>,</span>
<span>                    <span class="fl">20</span>,   <span class="fl">20</span>,   <span class="fl">10</span>,   <span class="fl">10</span>,   <span class="fl">10</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">10</span>,</span>
<span>                    <span class="fl">10</span>,   <span class="fl">10</span>,   <span class="fl">10</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,     <span class="fl">5</span>,</span>
<span>                    <span class="fl">10</span>,   <span class="fl">10</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,   <span class="fl">20</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,   <span class="fl">10</span>,    <span class="fl">10</span>,</span>
<span>                     <span class="fl">5</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,     <span class="fl">5</span>,</span>
<span>                    <span class="fl">10</span>,    <span class="fl">1</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,     <span class="fl">2</span>,</span>
<span>                    <span class="fl">10</span>,    <span class="fl">1</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,   <span class="fl">20</span>,    <span class="fl">2</span>,    <span class="fl">2</span>,    <span class="fl">1</span>,     <span class="fl">1</span>,</span>
<span>                    <span class="fl">20</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,   <span class="fl">10</span>,   <span class="fl">10</span>,   <span class="fl">10</span>,    <span class="fl">2</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,     <span class="fl">1</span>,</span>
<span>                    <span class="fl">20</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">2</span>,     <span class="fl">2</span>,</span>
<span>                    <span class="fl">10</span>,   <span class="fl">10</span>,   <span class="fl">10</span>,   <span class="fl">10</span>,    <span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">5</span>,    <span class="fl">5</span>,    <span class="fl">5</span>,     <span class="fl">5</span><span class="op">)</span>,</span>
<span>                  nrow <span class="op">=</span> <span class="fl">10</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">abs_data</span> <span class="op">=</span> <span class="va">res_data</span> <span class="op">*</span> <span class="fl">0</span> <span class="co"># Create a baseline mortality or absorption level. To experiment with background mortality rates, add a small number to this (e.g., `+ 0.0001`)</span></span>
<span><span class="va">abs_data</span><span class="op">[</span><span class="fl">6</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0.1</span> <span class="co"># Create a "highway" with high absorption and a safe crossing point</span></span>
<span><span class="va">abs_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">res_data</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="va">res_data</span> <span class="op">=</span> <span class="fu">samc</span><span class="fu">::</span><span class="fu"><a href="../reference/rasterize.html">rasterize</a></span><span class="op">(</span><span class="va">res_data</span><span class="op">)</span></span>
<span><span class="va">abs_data</span> <span class="op">=</span> <span class="fu">samc</span><span class="fu">::</span><span class="fu"><a href="../reference/rasterize.html">rasterize</a></span><span class="op">(</span><span class="va">abs_data</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_data</span>, main <span class="op">=</span> <span class="st">"Example Resistance Data"</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"y"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">abs_data</span>, main <span class="op">=</span> <span class="st">"Example Absorption Data"</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"y"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rw_model</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, dir <span class="op">=</span> <span class="fl">8</span>, sym <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">samc_obj</span> <span class="op">=</span> <span class="fu"><a href="../reference/samc.html">samc</a></span><span class="op">(</span><span class="va">res_data</span>, <span class="va">abs_data</span>, model <span class="op">=</span> <span class="va">rw_model</span><span class="op">)</span></span>
<span></span>
<span><span class="va">origin_coords</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dest_coords</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">9</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">origin_cell</span> <span class="op">=</span> <span class="fu"><a href="../reference/locate.html">locate</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">origin_coords</span><span class="op">)</span></span>
<span><span class="va">dest_cell</span> <span class="op">=</span> <span class="fu"><a href="../reference/locate.html">locate</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">dest_coords</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gdist</span> <span class="op">=</span> <span class="fu"><a href="https://AgrDataSci.github.io/gdistance/reference/transition.html" class="external-link">transition</a></span><span class="op">(</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="va">res_data</span><span class="op">)</span>, <span class="va">rw_model</span><span class="op">$</span><span class="va">fun</span>, <span class="va">rw_model</span><span class="op">$</span><span class="va">dir</span><span class="op">)</span></span>
<span><span class="va">gdist</span> <span class="op">=</span> <span class="fu"><a href="https://AgrDataSci.github.io/gdistance/reference/geoCorrection.html" class="external-link">geoCorrection</a></span><span class="op">(</span><span class="va">gdist</span><span class="op">)</span></span></code></pre></div>
<p><img src="article-circuit-theory_files/figure-html/unnamed-chunk-1-1.png" width="672" style="display: block; margin: auto;"><img src="article-circuit-theory_files/figure-html/unnamed-chunk-1-2.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="commute-time-and-hitting-time">Commute Time and Hitting Time<a class="anchor" aria-label="anchor" href="#commute-time-and-hitting-time"></a>
</h2>
<p><strong>Commute time</strong> (sometimes referred to as
<strong>commute distance</strong>), is the expected length of time, or
the number of steps, it takes to go from one node to another and back in
a graph using a random walk. In circuit theory, commute time is
proportional to the resistance distance between two nodes (Chandra et
al., 1997). This measure is bidirectional; it is the sum of going from
one node to another and back. Let us refer to commute time as <span class="math inline">\(C\)</span> where <span class="math inline">\(C_{ij}\)</span> is the commute time from node
<span class="math inline">\(i\)</span> to node <span class="math inline">\(j\)</span> and then back to node <span class="math inline">\(i\)</span>.</p>
<p><strong>Hitting time</strong>, or <strong>first passage
time</strong>, is the expected time, or the number of steps, it takes to
go from one node to another using a random walk. This measure is
unidirectional; it only accounts for going from one node to another, but
<em>not</em> back. The hitting times may not be equal for different
directions between two nodes depending on the situation. Let us refer to
hitting time using <span class="math inline">\(H\)</span>, where <span class="math inline">\(H_{ij}\)</span> is the hitting time from node
<span class="math inline">\(i\)</span> to node <span class="math inline">\(j\)</span>, and <span class="math inline">\(H_{ji}\)</span> is the hitting time from node
<span class="math inline">\(j\)</span> to node <span class="math inline">\(i\)</span>. <span class="math inline">\(H_{ij}\)</span> and <span class="math inline">\(H_{ij}\)</span> may or may not be equal.</p>
<p>Given these definitions, the sum of the two hitting times between two
nodes is the same as the commute time between the two nodes. That is,
<span class="math inline">\(C_{ij}=H_{ij}+H_{ji}\)</span>.</p>
<p>Circuit theory can be used to calculate the commute time between two
points via tools like Circuitscape (indirectly from resistance outputs)
or the gdistance R package (directly with the
<code><a href="https://AgrDataSci.github.io/gdistance/reference/commuteDistance-methods.html" class="external-link">commuteDistance()</a></code> function). In the SAMC, it can be
calculated by adding the hitting times in both directions. There are two
ways in which hitting times can be calculated with SAMC.</p>
<p>The first (limited) approach to calculating hitting times via SAMC is
with the <code><a href="../reference/survival.html">survival()</a></code> metric. This requires creating two
<code>samc</code> objects (one for each direction between two nodes). To
do so, the only non-zero absorption value needs to be at the destination
node (<span class="math inline">\(i\)</span> or <span class="math inline">\(j\)</span>, depending on the direction). As long
as absorption only occurs at the destination node and has an absorption
probability of <code>1</code>, the <code><a href="../reference/survival.html">survival()</a></code> function will
calculate the first passage time to that node. Applying the
<code><a href="../reference/survival.html">survival()</a></code> function to both samc objects and summing the
results will provide the commute time. This approach is limited because
it does not broadly allow for variation in absorption; graphs with
absorption occurring outside the destination nodes (<span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>) require an alternative approach.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Absorption only at the origin i</span></span>
<span><span class="va">abs_data_i</span> <span class="op">=</span> <span class="va">res_data</span> <span class="op">*</span> <span class="fl">0</span></span>
<span><span class="va">abs_data_i</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/xyCellFrom.html" class="external-link">cellFromXY</a></span><span class="op">(</span><span class="va">res_data</span>, <span class="va">origin_coords</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">abs_data_i</span>, main <span class="op">=</span> <span class="st">"Source Absorption Map"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Absorption only at the destination j</span></span>
<span><span class="va">abs_data_j</span> <span class="op">=</span> <span class="va">res_data</span> <span class="op">*</span> <span class="fl">0</span></span>
<span><span class="va">abs_data_j</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/xyCellFrom.html" class="external-link">cellFromXY</a></span><span class="op">(</span><span class="va">res_data</span>, <span class="va">dest_coords</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">abs_data_j</span>, main <span class="op">=</span> <span class="st">"Destination Absorption Map"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="article-circuit-theory_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;"><img src="article-circuit-theory_files/figure-html/unnamed-chunk-2-2.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create samc objects for each direction</span></span>
<span><span class="va">samc_ij</span> <span class="op">=</span> <span class="fu"><a href="../reference/samc.html">samc</a></span><span class="op">(</span><span class="va">res_data</span>, <span class="va">abs_data_j</span>, model <span class="op">=</span> <span class="va">rw_model</span><span class="op">)</span></span>
<span><span class="va">samc_ji</span> <span class="op">=</span> <span class="fu"><a href="../reference/samc.html">samc</a></span><span class="op">(</span><span class="va">res_data</span>, <span class="va">abs_data_i</span>, model <span class="op">=</span> <span class="va">rw_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate commute distance with samc</span></span>
<span><span class="va">hitting_ij</span> <span class="op">=</span> <span class="fu"><a href="../reference/survival.html">survival</a></span><span class="op">(</span><span class="va">samc_ij</span>, <span class="va">abs_data_i</span><span class="op">)</span> <span class="co"># Reusing the other abs layer as an occupancy input</span></span>
<span><span class="va">hitting_ji</span> <span class="op">=</span> <span class="fu"><a href="../reference/survival.html">survival</a></span><span class="op">(</span><span class="va">samc_ji</span>, <span class="va">abs_data_j</span><span class="op">)</span> <span class="co"># Reusing the other abs layer as an occupancy input</span></span>
<span></span>
<span><span class="va">hitting_ij</span></span>
<span><span class="co">#&gt; [1] 210.222</span></span>
<span><span class="va">hitting_ji</span></span>
<span><span class="co">#&gt; [1] 293.0998</span></span>
<span><span class="va">hitting_ij</span> <span class="op">+</span> <span class="va">hitting_ji</span></span>
<span><span class="co">#&gt; [1] 503.3218</span></span>
<span></span>
<span><span class="co"># Calculate commute distance with gdistance</span></span>
<span><span class="fu"><a href="https://AgrDataSci.github.io/gdistance/reference/commuteDistance-methods.html" class="external-link">commuteDistance</a></span><span class="op">(</span><span class="va">gdist</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">origin_coords</span>, <span class="va">dest_coords</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;          1</span></span>
<span><span class="co">#&gt; 2 501.3218</span></span></code></pre></div>
<p>There are a few key things to note here. First, the two commute
distance results are slightly different. This is because SAMC is
calculating the time to reach the destination plus one additional time
step for absorption. In circuit theory, these two transitions are not
considered separately; that is, reaching the destination is equivalent
to going to the ground state (absorption). This occurs twice (once in
each direction), which causes SAMC to have a commute distance that is
<code>2</code> time steps higher than what gdistance calculates.</p>
<p>The second thing to note is that the two hitting times produced by
SAMC are also slightly different. In other words, movement in one
direction between the two points is not equivalent to movement in the
other direction. This extra information about the total commute distance
can be useful in a real-world scenario. For example, gene flow between
two populations may be different in both directions. In this case, the
hitting times, rather than commute distance, may result in better models
comparing gene flow to landscape connectivity.</p>
<p>The second and more flexible approach in SAMC is the
<code><a href="../reference/cond_passage.html">cond_passage()</a></code> function, which directly calculates the
“conditional” first passage time in graphs where absorption can occur
anywhere. It is “conditional” because it only considers possible paths
through the graph where the destination node is reached. In other words,
when absorption is possible anywhere, there will be scenarios where the
destination is never reached, and these scenarios have to be excluded
for the calculation to work.</p>
<p><code><a href="../reference/cond_passage.html">cond_passage()</a></code> can be used in the same way described for
the <code><a href="../reference/survival.html">survival()</a></code> metric previously, in which case an
equivalent result to commute distance from circuit theory will be
obtained. Unlike the <code><a href="../reference/survival.html">survival()</a></code> function, the result of
<code><a href="../reference/cond_passage.html">cond_passage()</a></code> does not include the extra absorption time
step; it only calculates the time to reach the destination.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hitting_ij_cp</span> <span class="op">=</span> <span class="fu"><a href="../reference/cond_passage.html">cond_passage</a></span><span class="op">(</span><span class="va">samc_ij</span>, origin <span class="op">=</span> <span class="va">origin_cell</span>, dest <span class="op">=</span> <span class="va">dest_cell</span><span class="op">)</span></span>
<span><span class="va">hitting_ji_cp</span> <span class="op">=</span> <span class="fu"><a href="../reference/cond_passage.html">cond_passage</a></span><span class="op">(</span><span class="va">samc_ji</span>, origin <span class="op">=</span> <span class="va">dest_cell</span>, dest <span class="op">=</span> <span class="va">origin_cell</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hitting_ij_cp</span></span>
<span><span class="co">#&gt; [1] 209.222</span></span>
<span><span class="va">hitting_ji_cp</span></span>
<span><span class="co">#&gt; [1] 292.0998</span></span>
<span><span class="va">hitting_ij_cp</span> <span class="op">+</span> <span class="va">hitting_ji_cp</span></span>
<span><span class="co">#&gt; [1] 501.3218</span></span></code></pre></div>
<p>More importantly, this is just a special case where we demonstrate
the relationship between circuit theory and SAMC. For more generic
scenarios, only a single normal <code>samc</code> object is required for
calculating the hitting times:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate hitting times and commute distance for the original absorption data</span></span>
<span><span class="va">reg_hitting_ij</span> <span class="op">=</span> <span class="fu"><a href="../reference/cond_passage.html">cond_passage</a></span><span class="op">(</span><span class="va">samc_obj</span>, origin <span class="op">=</span> <span class="va">origin_cell</span>, dest <span class="op">=</span> <span class="va">dest_cell</span><span class="op">)</span></span>
<span><span class="va">reg_hitting_ji</span> <span class="op">=</span> <span class="fu"><a href="../reference/cond_passage.html">cond_passage</a></span><span class="op">(</span><span class="va">samc_obj</span>, origin <span class="op">=</span> <span class="va">dest_cell</span>, dest <span class="op">=</span> <span class="va">origin_cell</span><span class="op">)</span></span>
<span></span>
<span><span class="va">reg_hitting_ij</span></span>
<span><span class="co">#&gt; [1] 128.2726</span></span>
<span><span class="va">reg_hitting_ji</span></span>
<span><span class="co">#&gt; [1] 127.6531</span></span>
<span><span class="va">reg_hitting_ij</span> <span class="op">+</span> <span class="va">reg_hitting_ji</span></span>
<span><span class="co">#&gt; [1] 255.9258</span></span></code></pre></div>
<p>In this case, the resulting commute distance is much lower because
absorption occurs throughout the landscape. In the simplified scenario,
a lack of absorption (except for the destination) means that all
possible movement paths will eventually reach the destination. In
contrast, with landscape absorption, we now have scenarios where some of
those same movement paths are absorbed before reaching the destination.
Since those removed paths tended to be longer, their removal caused the
overall commute time to decrease.</p>
<p>To think about this, consider a landscape without any absorption. In
this scenario, individuals will continuously move around forever. This
leads to infinitely long paths. Once absorption is incorporated into the
landscape, the probability of these infinitely long paths occurring
decreases. As the overall probability of absorption in the landscape
increases, the overall probability of infinitely long paths occurring
will decrease. That is what happens when we switch from a circuit theory
model with only a single ground node (effectively a single absorption
point) to a SAMC model that allows absorption anywhere; the probability
of individuals existing indefinitely in the landscape will decrease, and
ideally, model a more realistic scenario.</p>
<p>Consider this in the context of dispersal and gene flow;
realistically, an individual dispersing from one population might never
make it to another population. For example, they might die along the
way. As a result, they would not contribute to gene flow between the two
populations in this case. SAMC provides a mechanism to account for this
possibility via the <code><a href="../reference/cond_passage.html">cond_passage()</a></code> function and the
incorporation of absorption more broadly.</p>
</div>
<div class="section level2">
<h2 id="net-and-total-movement-flow">Net and Total Movement Flow<a class="anchor" aria-label="anchor" href="#net-and-total-movement-flow"></a>
</h2>
<p>One application of circuit theory is the construction of current maps
that describe the net movement from one node to another. There is an
essential distinction between <strong>net</strong> and
<strong>total</strong> movement flow here; <strong>net</strong> movement
is the difference between movement flows in opposite directions, whereas
<strong>total</strong> movement is the sum of the movement flows in
opposite directions. These “current” flow maps are commonly used to
identify movement corridors and pinch points that may occur in
landscapes.</p>
<p>Current maps produced by Circuitscape model the net flow, and the
gdistance package can model both with the <code><a href="https://AgrDataSci.github.io/gdistance/reference/passage.html" class="external-link">passage()</a></code>
function. SAMC does not currently have a metric for directly calculating
net flow, but it can calculate the total movement directly using the
<code><a href="../reference/visitation.html">visitation()</a></code> metric. To get equivalent results between
gdistance and SAMC, we must again disregard absorption outside the
destination.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Total movement flow with gdistance</span></span>
<span><span class="va">total_gdist</span> <span class="op">=</span> <span class="fu"><a href="https://AgrDataSci.github.io/gdistance/reference/passage.html" class="external-link">passage</a></span><span class="op">(</span><span class="va">gdist</span>, <span class="va">origin_coords</span>, <span class="va">dest_coords</span>, theta <span class="op">=</span> <span class="fl">0</span>, totalNet <span class="op">=</span> <span class="st">"total"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">total_gdist</span>, main <span class="op">=</span> <span class="st">"Total Movement Flow (gdistance)"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Equivalent total movement flow with SAMC</span></span>
<span><span class="va">total_samc</span> <span class="op">=</span> <span class="fu"><a href="../reference/visitation.html">visitation</a></span><span class="op">(</span><span class="va">samc_ij</span>, origin <span class="op">=</span> <span class="va">origin_cell</span><span class="op">)</span></span>
<span><span class="va">total_samc_ras</span> <span class="op">=</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_ij</span>, <span class="va">total_samc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">total_samc_ras</span>, main <span class="op">=</span> <span class="st">"Total Movement Flow (samc)"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verify that they have the same values</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">total_gdist</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">total_samc_ras</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Attributes: &lt; target is NULL, current is list &gt;"</span></span>
<span><span class="co">#&gt; [2] "target is numeric, current is matrix"</span></span></code></pre></div>
<p><img src="article-circuit-theory_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"><img src="article-circuit-theory_files/figure-html/unnamed-chunk-6-2.png" width="672" style="display: block; margin: auto;"></p>
<p>With the total movement result and the <span class="math inline">\(Q\)</span> matrix from SAMC, it is possible to
calculate the net movement result and the <span class="math inline">\(Q\)</span> matrix. Currently, this is not a
built-in metric of the samc package, but a custom function can be
written to calculate it:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Net movement flow with gdistance</span></span>
<span><span class="va">net_gdist</span> <span class="op">=</span> <span class="fu"><a href="https://AgrDataSci.github.io/gdistance/reference/passage.html" class="external-link">passage</a></span><span class="op">(</span><span class="va">gdist</span>, <span class="va">origin_coords</span>, <span class="va">dest_coords</span>, theta <span class="op">=</span> <span class="fl">0</span>, totalNet <span class="op">=</span> <span class="st">"net"</span><span class="op">)</span></span>
<span><span class="va">net_gdist</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">net_gdist</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">net_gdist</span>, main <span class="op">=</span> <span class="st">"Net Movement Flow (gdistance)"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># This function may not be optimized for large landscapes and lacks safety checks</span></span>
<span><span class="va">visitation_net</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">origin</span>, <span class="va">dest</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>  <span class="va">vis</span> <span class="op">=</span> <span class="fu"><a href="../reference/visitation.html">visitation</a></span><span class="op">(</span><span class="va">samc_obj</span>, origin <span class="op">=</span> <span class="va">origin</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">vq</span> <span class="op">=</span> <span class="va">vis</span><span class="op">*</span><span class="va">samc_obj</span><span class="op">$</span><span class="va">q_matrix</span></span>
<span></span>
<span>  <span class="va">n_net</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/symmpart.html" class="external-link">skewpart</a></span><span class="op">(</span><span class="va">vq</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">visit_net</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">n_net</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">n_net</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">visit_net</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">origin</span>, <span class="va">dest</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="va">visit_net</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">origin</span>, <span class="va">dest</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">visit_net</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Equivalent net movement flow with SAMC</span></span>
<span><span class="va">net_samc</span> <span class="op">=</span> <span class="fu">visitation_net</span><span class="op">(</span><span class="va">samc_ij</span>, origin <span class="op">=</span> <span class="va">origin_cell</span>, dest <span class="op">=</span> <span class="va">dest_cell</span><span class="op">)</span></span>
<span><span class="va">net_samc_ras</span> <span class="op">=</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">net_samc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">net_samc_ras</span>,  main <span class="op">=</span> <span class="st">"Net Movement Flow (samc)"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Verify that they have the same values</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">net_gdist</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">net_samc_ras</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Attributes: &lt; Component \"dimnames\": Component 2: 1 string mismatch &gt;"</span></span></code></pre></div>
<p><img src="article-circuit-theory_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"><img src="article-circuit-theory_files/figure-html/unnamed-chunk-7-2.png" width="672" style="display: block; margin: auto;"></p>
<p>As with commute distance, SAMC is not limited to calculating the
total and net movement flows for landscapes without absorption.
<code><a href="../reference/visitation.html">visitation()</a></code> and the net visitation calculations are
perfectly valid for our original samc object with broader landscape
absorption.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg_net_samc</span> <span class="op">=</span> <span class="fu">visitation_net</span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">origin_cell</span>, <span class="va">dest_cell</span><span class="op">)</span></span>
<span><span class="va">reg_samc_ras</span> <span class="op">=</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">samc_obj</span>, <span class="va">reg_net_samc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">reg_samc_ras</span>,  main <span class="op">=</span> <span class="st">"Net Movement Flow (samc with absorption)"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="article-circuit-theory_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Overall, incorporating absorption more broadly has reduced the net
movement flow because a portion of the individuals is now being removed
before reaching the destination. More importantly, the incorporation of
absorption now means the destination is not guaranteed to be reached,
leading to a dramatic drop in the net movement at the destination cell.
We can subtract the absorption model from the non-absorption model to
see how much net movement flow has decreased.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">net_gdist</span> <span class="op">-</span> <span class="va">reg_samc_ras</span>, main <span class="op">=</span> <span class="st">"Effect of Absorption on Net Movement Flow"</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="article-circuit-theory_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
<p>This shows a nearly imperceptible effect of the absorption layer on
the net movement flow below the strip of absorption, but as individuals
encounter absorption, the net movement flow in the top half of the map
drops dramatically. We can see that the presence of the absorption strip
has decreased the net movement flow at the destination over 97%:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">net_samc_ras</span><span class="op">[</span><span class="va">dest_cell</span><span class="op">]</span> <span class="co"># Net movement flow at destination w/o absorption</span></span>
<span><span class="co">#&gt;   lyr.1</span></span>
<span><span class="co">#&gt; 1     1</span></span>
<span><span class="va">reg_net_samc</span><span class="op">[</span><span class="va">dest_cell</span><span class="op">]</span> <span class="co"># With absorption</span></span>
<span><span class="co">#&gt; [1] 0.02681907</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Andrew Marx.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
