<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create an samc object — samc • samc</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create an samc object — samc" />
<meta property="og:description" content="Create an samc object that contains the absorbing Markov chain data" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">samc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/performance.html">Performance</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Parallel Computing</a>
    </li>
    <li>
      <a href="../articles/troubleshooting.html">Troubleshooting</a>
    </li>
    <li>
      <a href="../articles/code-snippets.html">Code Snippets</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/data-disconnected.html">Disconnected Data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/tutorial-basic.html">Basic Tutorial</a>
    </li>
    <li>
      <a href="../articles/tutorial-locations.html">Locations</a>
    </li>
    <li>
      <a href="../articles/tutorial-ggplot.html">ggplot Visualization</a>
    </li>
    <li>
      <a href="../articles/tutorial-temporal.html">Temporal Analysis</a>
    </li>
    <li>
      <a href="../articles/tutorial-animations.html">Animations</a>
    </li>
    <li>
      <a href="../articles/tutorial-multiple-absorption.html">Multiple Absorption</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/example-maze-part1.html">Maze (Part 1)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/andrewmarx/samc">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create an samc object</h1>
    <small class="dont-index">Source: <a href='https://github.com/andrewmarx/samc/blob/master/R/samc.R'><code>R/samc.R</code></a></small>
    <div class="hidden name"><code>samc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create an samc object that contains the absorbing Markov chain data</p>
    </div>

    <pre class="usage"><span class='fu'>samc</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>absorption</span>, <span class='va'>fidelity</span>, <span class='va'>tr_args</span><span class='op'>)</span>

<span class='co'># S4 method for TransitionLayer,RasterLayer,RasterLayer,missing</span>
<span class='fu'>samc</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>absorption</span>, <span class='va'>fidelity</span><span class='op'>)</span>

<span class='co'># S4 method for TransitionLayer,RasterLayer,missing,missing</span>
<span class='fu'>samc</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>absorption</span><span class='op'>)</span>

<span class='co'># S4 method for RasterLayer,RasterLayer,RasterLayer,list</span>
<span class='fu'>samc</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>absorption</span>, <span class='va'>fidelity</span>, <span class='va'>tr_args</span><span class='op'>)</span>

<span class='co'># S4 method for RasterLayer,RasterLayer,missing,list</span>
<span class='fu'>samc</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>absorption</span>, <span class='va'>tr_args</span><span class='op'>)</span>

<span class='co'># S4 method for matrix,matrix,matrix,list</span>
<span class='fu'>samc</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>absorption</span>, <span class='va'>fidelity</span>, <span class='va'>tr_args</span><span class='op'>)</span>

<span class='co'># S4 method for matrix,matrix,missing,list</span>
<span class='fu'>samc</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>absorption</span>, <span class='va'>tr_args</span><span class='op'>)</span>

<span class='co'># S4 method for dgCMatrix,missing,missing,missing</span>
<span class='fu'>samc</span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span>

<span class='co'># S4 method for matrix,missing,missing,missing</span>
<span class='fu'>samc</span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A <code><a href='https://rdrr.io/pkg/raster/man/Raster-classes.html'>RasterLayer-class</a></code> or <code><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></code> or Matrix package dgCMatrix sparse matrix.</p></td>
    </tr>
    <tr>
      <th>absorption</th>
      <td><p>A <code><a href='https://rdrr.io/pkg/raster/man/Raster-classes.html'>RasterLayer-class</a></code> or <code><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></code></p></td>
    </tr>
    <tr>
      <th>fidelity</th>
      <td><p>A <code><a href='https://rdrr.io/pkg/raster/man/Raster-classes.html'>RasterLayer-class</a></code> or <code><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></code></p></td>
    </tr>
    <tr>
      <th>tr_args</th>
      <td><p>A list with args for constructing a transition matrix.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code><a href='samc-class.html'>samc-class</a></code> object</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is used to create a <code><a href='samc-class.html'>samc-class</a></code> object. There are
multiple options for creating this object.</p>
<p><strong>Option 1: Raster or Matrix Maps</strong></p>
<p><em><code>samc(data = matrix, absorption = matrix, fidelity = matrix, tr_args = list())</code></em></p>
<p><em><code>samc(data = RasterLayer, absorption = RasterLayer, fidelity = RasterLayer, tr_args = list())</code></em></p>
<p>The <code><a href='samc-class.html'>samc-class</a></code> object can be created from a combination of
resistance (or conductance), absorption, and fidelity data. These different landscape data
inputs must be the same type (a matrix or RasterLayer), and have identical
properties, including dimensions, location of NA cells, and CRS (if using
RasterLayers).</p>
<p>The <code>data</code> and <code>absorption</code> inputs are always mandatory for this approach. The
<code>fidelity</code> input is optional. If the <code>fidelity</code> input is not provided, then it it
is assumed that there is no site fidelity (i.e., individuals will always move
to an adjacent cell each time step).</p>
<p>The <code>tr_args</code> parameter is mandatory. It used when calculating the values for
the transition matrix. Internally, is used in the <code><a href='https://rdrr.io/pkg/gdistance/man/transition.html'>transition</a></code>
function in the gdistance package to create the transition matrix. <code>tr_args</code>
must be constructed as list with a transition function, the number of directions (4 or 8),
and if the transition function is symmetric (TRUE or FALSE). Here is the template:
<code><a href='https://rdrr.io/r/base/list.html'>list(fun = `function`, dir = `numeric`, sym = `logical`)</a></code></p>
<p><strong>Option 2: TransitionLayer</strong></p>
<p><em><code>samc(data = TransitionLayer, absorption = RasterLayer, fidelity = RasterLayer)</code></em></p>
<p>The <code>data</code> parameter can be a <code>TransitionLayer</code> object created using the gdistance package.
In this case the <code>absorption</code> parameter is mandatory and should be a RasterLayer
that has identical properties to the RasterLayer used to create the TransitionLayer
object. The <code>fidelity</code> parameter is optional and has the same requirements as
the <code>absorption</code> parameter. The <code><a href='check.html'>check</a></code> function can be used to
verify these requirements.</p>
<p>The advantage of this approach is that it offers slightly more flexibility than
the first option. Namely, it's useful if the TransitionLayer needs additional
modifications before it is normalized with the absorption and fidelity inputs.
The disadvantage compared to the first option is that samc() cannot detect certain
issues when the TransitionLayer is manually created and modified. So if users
do not need to manually modify the TransitionLayer, then the first option for
creating a samc object is recommended.</p>
<p><strong>Option 3: P Matrix</strong></p>
<p><em><code>samc(data = matrix)</code></em></p>
<p><em><code>samc(data = dgCMatrix)</code></em></p>
<p>The <code>data</code> parameter can be used alone to create a <code><a href='samc-class.html'>samc-class</a></code> object
directly from a preconstructed P matrix. This matrix must be either a base R
matrix, or a sparse matrix (dgCMatrix format) from the Matrix package. It
must meet the following requirements:</p><ul>
<li><p>The number of rows must equal the number of columns (a square matrix)</p></li>
<li><p>Total absorption must be a single column on the right-hand side of the matrix</p></li>
<li><p>At the bottom of the matrix, there must be a row filled with 0's except
  for last element (bottom-right of the matrix diagonal), which must be set to 1</p></li>
<li><p>Every disconnected region of the matrix must have at least one non-zero
  absorbing value</p></li>
<li><p>Each row must sum to 1</p></li>
<li><p>All values must be in the range of 0-1</p></li>
</ul>

<p>Additionally, the columns and rows of the P matrix may be named (e.g., using
dimnames(), rowname(), colnames(), etc). When specifying <code>origin</code> or <code>dest</code> inputs
to metrics, these names may be used instead of cell numbers. This has the
advantage of making the code for an analysis easier to read and interpret,
which may also help to eliminate unintentional mistakes. There are two
requirements for naming the rows/cols of a P matrix. First, since the P matrix
represents a pairwise matrix, the row and column names must be the same. Second,
there must be no duplicate names. The exception to these rules is the very last
column and the very last row of the P matrix. Since these are not part of the
pairwise transition matrix, they may have whatever names the user prefers.</p>
<p><strong>Additional Information</strong></p>
<p>Depending on the data used to construct the samc-class object, some metrics
may cause crashes. This is a result of the underlying P matrix having specific
properties that make some equations unsolvable. One known case is a P matrix
that represents a disconnected graph, which can lead to the <code><a href='cond_passage.html'>cond_passage()</a></code>
function crashing. In terms of raster/matrix inputs, a disconnected graph
occurs when one or more pixels/cells are unreachable from other pixels/cells
due to the presence of a full barrier made up of NA values. In a raster, these
may be obvious as islands, but can be as inconspicuous as a rogue isolated
pixel. There may be other currently unknown situations that lead to unsolvable
metrics.</p>
<p>Future work is planned towards identifying these issues during creation of the
samc-class object and handling them appropriately to prevent inadvertent
crashes.</p>
<p><strong>Version 2 Changes</strong></p>
<p>Version 1.5.0 officially removed support for the deprecated <code>resistance</code>, <code>tr_fun</code>,
<code>directions</code>, <code>p_mat</code>, <code>latlon</code>, and <code>override</code> arguments. Old
code will have to be updated to the new samc() function structure in order to work.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># "Load" the data. In this case we are using data built into the package.</span>
<span class='co'># In practice, users will likely load raster data using the raster() function</span>
<span class='co'># from the raster package.</span>
<span class='va'>res_data</span> <span class='op'>&lt;-</span> <span class='fu'>samc</span><span class='fu'>::</span><span class='va'><a href='ex_res_data.html'>ex_res_data</a></span>
<span class='va'>abs_data</span> <span class='op'>&lt;-</span> <span class='fu'>samc</span><span class='fu'>::</span><span class='va'><a href='ex_abs_data.html'>ex_abs_data</a></span>
<span class='va'>occ_data</span> <span class='op'>&lt;-</span> <span class='fu'>samc</span><span class='fu'>::</span><span class='va'><a href='ex_occ_data.html'>ex_occ_data</a></span>


<span class='co'># Make sure our data meets the basic input requirements of the package using</span>
<span class='co'># the check() function.</span>
<span class='fu'><a href='check.html'>check</a></span><span class='op'>(</span><span class='va'>res_data</span>, <span class='va'>abs_data</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='fu'><a href='check.html'>check</a></span><span class='op'>(</span><span class='va'>res_data</span>, <span class='va'>occ_data</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
<span class='co'># Setup the details for our transition function</span>
<span class='va'>tr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fun <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fl'>1</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, <span class='co'># Function for calculating transition probabilities</span>
           dir <span class='op'>=</span> <span class='fl'>8</span>, <span class='co'># Directions of the transitions. Either 4 or 8.</span>
           sym <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='co'># Is the function symmetric?</span>


<span class='co'># Create a `samc-class` object with the resistance and absorption data using</span>
<span class='co'># the samc() function. We use the recipricol of the arithmetic mean for</span>
<span class='co'># calculating the transition matrix. Note, the input data here are matrices,</span>
<span class='co'># not RasterLayers.</span>
<span class='va'>samc_obj</span> <span class='op'>&lt;-</span> <span class='fu'>samc</span><span class='op'>(</span><span class='va'>res_data</span>, <span class='va'>abs_data</span>, tr_args <span class='op'>=</span> <span class='va'>tr</span><span class='op'>)</span>


<span class='co'># Convert the occupancy data to probability of occurrence</span>
<span class='va'>occ_prob_data</span> <span class='op'>&lt;-</span> <span class='va'>occ_data</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>occ_data</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>


<span class='co'># Calculate short- and long-term metrics using the analytical functions</span>
<span class='va'>short_mort</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mortality.html'>mortality</a></span><span class='op'>(</span><span class='va'>samc_obj</span>, <span class='va'>occ_prob_data</span>, time <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span>
<span class='va'>short_dist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='distribution.html'>distribution</a></span><span class='op'>(</span><span class='va'>samc_obj</span>, origin <span class='op'>=</span> <span class='fl'>3</span>, time <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span>
<span class='va'>long_disp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='dispersal.html'>dispersal</a></span><span class='op'>(</span><span class='va'>samc_obj</span>, <span class='va'>occ_prob_data</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Cached diagonal not found.
#&gt; Performing setup. This can take several minutes... Complete.
#&gt; Calculating matrix inverse diagonal...
#&gt; Complete                                                      
#&gt; Diagonal has been cached. Continuing with metric calculation...</div><div class='input'><span class='va'>visit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='visitation.html'>visitation</a></span><span class='op'>(</span><span class='va'>samc_obj</span>, dest <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>
<span class='va'>surv</span> <span class='op'>&lt;-</span> <span class='fu'><a href='survival.html'>survival</a></span><span class='op'>(</span><span class='va'>samc_obj</span><span class='op'>)</span>


<span class='co'># Use the map() function to turn vector results into RasterLayer objects.</span>
<span class='va'>short_mort_map</span> <span class='op'>&lt;-</span> <span class='fu'><a href='map.html'>map</a></span><span class='op'>(</span><span class='va'>samc_obj</span>, <span class='va'>short_mort</span><span class='op'>)</span>
<span class='va'>short_dist_map</span> <span class='op'>&lt;-</span> <span class='fu'><a href='map.html'>map</a></span><span class='op'>(</span><span class='va'>samc_obj</span>, <span class='va'>short_dist</span><span class='op'>)</span>
<span class='va'>long_disp_map</span> <span class='op'>&lt;-</span> <span class='fu'><a href='map.html'>map</a></span><span class='op'>(</span><span class='va'>samc_obj</span>, <span class='va'>long_disp</span><span class='op'>)</span>
<span class='va'>visit_map</span> <span class='op'>&lt;-</span> <span class='fu'><a href='map.html'>map</a></span><span class='op'>(</span><span class='va'>samc_obj</span>, <span class='va'>visit</span><span class='op'>)</span>
<span class='va'>surv_map</span> <span class='op'>&lt;-</span> <span class='fu'><a href='map.html'>map</a></span><span class='op'>(</span><span class='va'>samc_obj</span>, <span class='va'>surv</span><span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andrew Marx.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


